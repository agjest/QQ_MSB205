<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.1.189">

  <meta name="author" content="Arnstein Gjestland">
  <title>MSB205 - Spatial regressions area data</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
    }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="center">
  <h1 class="title">Spatial regressions area data</h1>
  <p class="author">Arnstein Gjestland</p>
  <p class="institute">HVL</p>
  <p class="date">Spring 2021 (revised autumn 2022)</p>
</section>

<section class="slide level2">

<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(PxWebApiData)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(sp)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(spdep)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(spatialreg)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">library</span>(mctest)</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="fu">library</span>(huxtable)</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="fu">library</span>(tmap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">

</div>
</section>
<section>
<section id="models" class="title-slide slide level1 center">
<h1>Models</h1>

</section>
<section id="read-in-data-via-map." class="slide level2">
<h2>Read in data via map.</h2>
<ul>
<li class="fragment">This is the municipalities map with data from SSB generated under <a href="../data/">Getting Data</a>.</li>
</ul>
<div class="fragment">
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># run data/get_ssb_data.Rmd if data needs to be updated</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>map_data_2017 <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"../data/map_data_2017.gpkg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `map_data_2017' from data source 
  `/Users/ag/Dev/QQ_MSB205/spatmetrics/data/map_data_2017.gpkg' 
  using driver `GPKG'
Simple feature collection with 426 features and 115 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -99551.21 ymin: 6426048 xmax: 1121941 ymax: 7962744
Projected CRS: ETRS89 / UTM zone 33N + NN2000 height</code></pre>
</div>
</div>
<ul>
<li class="fragment">Filter out municipalities with no recorded pm2.</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>map_data_2017_noNA <span class="ot">&lt;-</span> map_data_2017 <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(log_pm2))</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># Drop obs. 14, 1416 Høyanger because of no neighbours. Makes life simpler</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>map_data_2017_noNA <span class="ot">&lt;-</span> map_data_2017_noNA[<span class="sc">-</span><span class="dv">14</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</section>
<section id="make-new-variables" class="slide level2">
<h2>Make new variables</h2>
<ul>
<li class="fragment">Make new variables and strip down dataset to variables we will use</li>
</ul>
<div class="fragment">
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" data-code-line-numbers="4|8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>md_2017 <span class="ot">&lt;-</span> map_data_2017_noNA <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-3"><a href="#cb5-3"></a>    <span class="co"># percentage of pop. in a working age</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>    <span class="at">prct_20_64 =</span> <span class="dv">100</span><span class="sc">*</span>pop_20_64<span class="sc">/</span>tot_pop,</span>
<span id="cb5-5"><a href="#cb5-5"></a>    <span class="co"># log percentage of pop. of a working age</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>    <span class="at">log_prct_20_64 =</span> <span class="fu">log</span>(<span class="dv">100</span><span class="sc">*</span>pop_20_64<span class="sc">/</span>tot_pop),</span>
<span id="cb5-7"><a href="#cb5-7"></a>    <span class="co"># log percentage of pop. with an univeristy education</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>    <span class="at">log_prct_uni_edu =</span> <span class="fu">log</span>(edu_uni_short <span class="sc">+</span> edu_uni_long),</span>
<span id="cb5-9"><a href="#cb5-9"></a>    <span class="co"># log percentage of households with an income above NOK 750.000</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>    <span class="at">log_inc_750k_p =</span> <span class="fu">log</span>(inc_750k_p),</span>
<span id="cb5-11"><a href="#cb5-11"></a>    <span class="co"># percentage of household wealth above 3.000.000</span></span>
<span id="cb5-12"><a href="#cb5-12"></a>    <span class="at">net_cap_3000k_p =</span> net_cap_3000k_4000k <span class="sc">+</span> net_cap_4000k_p,</span>
<span id="cb5-13"><a href="#cb5-13"></a>    <span class="co"># log percentage of household wealth above 3.000.000</span></span>
<span id="cb5-14"><a href="#cb5-14"></a>    <span class="at">log_net_cap_3000k_p =</span> <span class="fu">log</span>(net_cap_3000k_4000k <span class="sc">+</span> net_cap_4000k_p),</span>
<span id="cb5-15"><a href="#cb5-15"></a>    <span class="co"># gov emp relative to pop_20_64</span></span>
<span id="cb5-16"><a href="#cb5-16"></a>    <span class="at">gov_emp_rel =</span> <span class="dv">100</span><span class="sc">*</span>gov_emp<span class="sc">/</span>pop_20_64,</span>
<span id="cb5-17"><a href="#cb5-17"></a>    <span class="co"># log (number of gov. emp. + 1)</span></span>
<span id="cb5-18"><a href="#cb5-18"></a>    <span class="at">log_gov_emp =</span> <span class="fu">log</span>(<span class="dv">100</span><span class="sc">*</span>(gov_emp<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>pop_20_64),</span>
<span id="cb5-19"><a href="#cb5-19"></a>    <span class="co"># scale spc, to trane in NOK 1000</span></span>
<span id="cb5-20"><a href="#cb5-20"></a>    <span class="at">spc_k =</span> spc<span class="sc">/</span><span class="dv">1000</span>,</span>
<span id="cb5-21"><a href="#cb5-21"></a>    <span class="co"># log trade revenue per capita</span></span>
<span id="cb5-22"><a href="#cb5-22"></a>    <span class="at">log_spc =</span> <span class="fu">log</span>(spc),</span>
<span id="cb5-23"><a href="#cb5-23"></a>    <span class="co"># log of centrality index (max index value 1000)</span></span>
<span id="cb5-24"><a href="#cb5-24"></a>    <span class="at">log_sen_ind =</span> <span class="fu">log</span>(sen_ind),</span>
<span id="cb5-25"><a href="#cb5-25"></a>    <span class="co"># percentage in two top deciles of before tax income</span></span>
<span id="cb5-26"><a href="#cb5-26"></a>    <span class="at">inc_bt_9and10 =</span> inc_bt_09 <span class="sc">+</span> inc_bt_10</span>
<span id="cb5-27"><a href="#cb5-27"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb5-28"><a href="#cb5-28"></a>  <span class="fu">select</span>(knr, kNavn, log_pm2, prct_20_64, gov_emp, gov_emp_rel, spc, spc_k, inc_750k_p, sen_ind, net_cap_3000k_p, inc_bt_9and10, log_prct_20_64, log_prct_uni_edu, </span>
<span id="cb5-29"><a href="#cb5-29"></a>         log_inc_750k_p, log_net_cap_3000k_p, log_gov_emp, log_spc,log_sen_ind, sfd_ba_completed, sfd_w2u_ba_completed) <span class="sc">%&gt;%</span> </span>
<span id="cb5-30"><a href="#cb5-30"></a>  <span class="fu">arrange</span>(knr)</span>
<span id="cb5-31"><a href="#cb5-31"></a><span class="co"># write out reduced dataset</span></span>
<span id="cb5-32"><a href="#cb5-32"></a><span class="fu">st_write</span>(<span class="at">obj =</span> md_2017, <span class="at">dsn =</span> <span class="st">"../data/md_2017.gpkg"</span>, <span class="at">driver =</span> <span class="st">"GPKG"</span>, <span class="at">append=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Deleting layer `md_2017' using driver `GPKG'
Writing layer `md_2017' to data source `../data/md_2017.gpkg' using driver `GPKG'
Writing 330 features with 21 fields and geometry type Multi Polygon.</code></pre>
</div>
</div>
</div>
</section>
<section id="remove-høyanger-no-neighbours." class="slide level2">
<h2>Remove Høyanger, no neighbours.</h2>
<ul>
<li class="fragment">We have to remove the municipality “Høyanger” since it has no neighbour with data (only NAs).</li>
</ul>
<div class="fragment">
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>md_2017 <span class="ot">&lt;-</span> md_2017 <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">filter</span>(<span class="sc">!</span>kNavn <span class="sc">==</span> <span class="st">"Høyanger"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li class="fragment">Making the weights matrix.</li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-hash="index_cache/revealjs/unnamed-chunk-7_54bf2ad6ea5ff8646aebc8505fc8c105">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># remove line 200 Høyanger, no neighbours</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>md_2017_nb <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(md_2017)</span>
<span id="cb8-3"><a href="#cb8-3"></a>md_2017_nb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 329 
Number of nonzero links: 1556 
Percentage nonzero weights: 1.437533 
Average number of links: 4.729483 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>md_2017_w <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(md_2017_nb, <span class="at">style =</span> <span class="st">"W"</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">print</span>(md_2017_w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 329 
Number of nonzero links: 1556 
Percentage nonzero weights: 1.437533 
Average number of links: 4.729483 

Weights style: W 
Weights constants summary:
    n     nn  S0       S1       S2
W 329 108241 329 156.7205 1357.883</code></pre>
</div>
</div>
</div>
</section>
<section id="global-morans-i-plot-for-log_pm2" class="slide level2">
<h2>Global Morans I plot for log_pm2</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">moran.plot</span>(md_2017<span class="sc">$</span>log_pm2, <span class="at">listw =</span> md_2017_w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch"></section>
<section id="moran-test-on-dependant-variable" class="slide level2">
<h2>Moran test on dependant variable</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">moran.test</span>(md_2017<span class="sc">$</span>log_pm2, <span class="at">listw =</span> md_2017_w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Moran I test under randomisation

data:  md_2017$log_pm2  
weights: md_2017_w    

Moran I statistic standard deviate = 14.014, p-value &lt; 2.2e-16
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance 
      0.526358833      -0.003048780       0.001427167 </code></pre>
</div>
</div>
<ul>
<li class="fragment">Hardly any doubt that we have spatial autocorrelation in log_pm2 (not a big surprise).</li>
</ul>
</section>
<section id="eda" class="slide level2">
<h2>EDA</h2>
<p>Open a new project in Geoda and read in the reduced dataset md_2017 and do EDA.</p>
</section>
<section id="the-model" class="slide level2">
<h2>The model</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>mod1 <span class="ot">&lt;-</span> <span class="st">"log_pm2 ~ log_prct_20_64 + log_prct_uni_edu + log_inc_750k_p</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="st"> + log_net_cap_3000k_p + log_gov_emp + log_spc + log_sen_ind"</span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co"># mod2 &lt;- "log_pm2 ~ log_prct_20_64 +  log_net_cap_3000k_p + log_sen_ind"</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>mod2 <span class="ot">&lt;-</span> <span class="st">"log_pm2 ~ prct_20_64 + inc_bt_9and10 + spc_k +  sen_ind"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="the-variables-we-use" class="slide level2">
<h2>The variables we use</h2>
<p>We have 329 observations. We lack pm2 for 96 municipalities. One, Høyanger, no NA, but no neighbours which have registered data (only NAs).</p>
<dl>
<dt class="fragment">log_pm2</dt>
<dd class="fragment">
<p>We use the natural logarithms of price per square meter as our dependent variable.</p>
</dd>
<dt class="fragment">prct_20_64</dt>
<dd class="fragment">
<p>Percentage of population of a “working age”.</p>
</dd>
<dt class="fragment">inc_bt_9and10</dt>
<dd class="fragment">
<p>This variable is a little bit more involved. Imagine income for all income earners of the country ordered in a long list, from lowest to highest income. This list is then divided into 10 parts with an equal number of individuals in each part. Then we will have 9 income levels <span class="math inline">\(I_{i,i+1}, i = 1\ldots 9\)</span> representing the border between to groups (deciles). If an individual has an income above <span class="math inline">\(I_{8,9}\)</span>, this individual will be in the top 20% earners in the country. Our variable <code>inc_bt_9and10</code> contains the percentage of income earners in each municipality that has an income above <span class="math inline">\(I_{8,9}\)</span>.</p>
</dd>
<dt class="fragment">spc_k</dt>
<dd class="fragment">
<p>Wholesale and retail trade sales per capita in each municipality in NOK 1000.</p>
</dd>
<dt class="fragment">sen_ind</dt>
<dd class="fragment">
<p>The value of the SSB centrality index for 2018. The index value for Oslo (the most central place) is 1000.</p>
</dd>
</dl>
</section>
<section id="simple-linear-model" class="slide level2">
<h2>Simple linear model</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>md_2017 <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">select</span>(log_pm2, prct_20_64, inc_bt_9and10, spc_k, sen_ind) <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    log_pm2         prct_20_64    inc_bt_9and10       spc_k       
 Min.   : 8.579   Min.   :51.51   Min.   : 8.10   Min.   : 10.24  
 1st Qu.: 9.491   1st Qu.:55.23   1st Qu.:14.90   1st Qu.: 43.97  
 Median : 9.725   Median :56.70   Median :17.60   Median : 65.24  
 Mean   : 9.738   Mean   :56.75   Mean   :18.15   Mean   : 67.86  
 3rd Qu.: 9.970   3rd Qu.:58.04   3rd Qu.:20.60   3rd Qu.: 88.05  
 Max.   :10.960   Max.   :66.14   Max.   :35.50   Max.   :228.10  
    sen_ind                  geom    
 Min.   : 368.0   MULTIPOLYGON :329  
 1st Qu.: 616.0   epsg:5973    :  0  
 Median : 686.0   +proj=utm ...:  0  
 Mean   : 700.3                      
 3rd Qu.: 793.0                      
 Max.   :1000.0                      </code></pre>
</div>
</div>
</section>
<section id="is-multicollinearity-a-problem" class="slide level2">
<h2>Is multicollinearity a problem?</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># drop gov_emp_1k</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mod2, <span class="at">data =</span> md_2017)</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="fu">summary</span>(lm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mod2, data = md_2017)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.46579 -0.09363  0.00813  0.09060  0.55811 

Coefficients:
               Estimate Std. Error t value    Pr(&gt;|t|)    
(Intercept)   6.1907249  0.2926722  21.152     &lt; 2e-16 ***
prct_20_64    0.0315756  0.0059235   5.331 0.000000184 ***
inc_bt_9and10 0.0327213  0.0022935  14.267     &lt; 2e-16 ***
spc_k         0.0009024  0.0003210   2.812     0.00523 ** 
sen_ind       0.0015705  0.0001080  14.546     &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1706 on 324 degrees of freedom
Multiple R-squared:  0.7941,    Adjusted R-squared:  0.7916 
F-statistic: 312.4 on 4 and 324 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="is-multicollinearity-a-problem-1" class="slide level2">
<h2>Is multicollinearity a problem?</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">mctest</span>(lm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
omcdiag(mod = mod, Inter = TRUE, detr = detr, red = red, conf = conf, 
    theil = theil, cn = cn)


Overall Multicollinearity Diagnostics

                       MC Results detection
Determinant |X'X|:         0.4439         0
Farrar Chi-Square:       264.6359         1
Red Indicator:             0.3663         0
Sum of Lambda Inverse:     5.9601         0
Theil's Method:           -1.2117         0
Condition Number:        103.8824         1

1 --&gt; COLLINEARITY is detected by the test 
0 --&gt; COLLINEARITY is not detected by the test</code></pre>
</div>
</div>
</section>
<section id="is-multicollinearity-a-problem-cont." class="slide level2">
<h2>Is multicollinearity a problem? cont.</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">imcdiag</span>(lm2, <span class="at">all =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
imcdiag(mod = lm2, all = TRUE)


All Individual Multicollinearity Diagnostics in 0 or 1 

              VIF TOL Wi Fi Leamer CVIF Klein IND1 IND2
prct_20_64      0   0  1  1      0    0     0    1    0
inc_bt_9and10   0   0  1  1      0    0     0    0    0
spc_k           0   0  1  1      0    0     0    0    0
sen_ind         0   0  1  1      0    0     0    1    0

1 --&gt; COLLINEARITY is detected by the test 
0 --&gt; COLLINEARITY is not detected by the test

* all coefficients have significant t-ratios

R-square of y on all x: 0.7941 

* use method argument to check which regressors may be the reason of collinearity
===================================</code></pre>
</div>
</div>
</section>
<section id="is-multicollinearity-a-problem-cont.-1" class="slide level2">
<h2>Is multicollinearity a problem? cont.</h2>
<p>Three out of nine tests indicate that multicollinearity might be a problem.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># If we only want to do one test</span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="fu">imcdiag</span>(lm2, <span class="at">method =</span> <span class="st">"VIF"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
imcdiag(mod = lm2, method = "VIF")


 VIF Multicollinearity Diagnostics

                 VIF detection
prct_20_64    1.7674         0
inc_bt_9and10 1.2125         0
spc_k         1.1040         0
sen_ind       1.8762         0

NOTE:  VIF Method Failed to detect multicollinearity


0 --&gt; COLLINEARITY is not detected by the test

===================================</code></pre>
</div>
</div>
</section>
<section id="is-multicollinearity-a-problem-cont.-2" class="slide level2">
<h2>Is multicollinearity a problem? cont.</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># If we only want to do one test</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="fu">imcdiag</span>(lm2, <span class="at">method =</span> <span class="st">"IND1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
imcdiag(mod = lm2, method = "IND1")


 IND1 Multicollinearity Diagnostics

                IND1 detection
prct_20_64    0.0052         1
inc_bt_9and10 0.0076         0
spc_k         0.0084         0
sen_ind       0.0049         1

Multicollinearity may be due to prct_20_64 sen_ind regressors

1 --&gt; COLLINEARITY is detected by the test 
0 --&gt; COLLINEARITY is not detected by the test

===================================</code></pre>
</div>
</div>
</section>
<section id="correlation" class="slide level2">
<h2>Correlation</h2>
<ul>
<li class="fragment">The positive correlation between <code>sen_ind</code> and <code>prct_20_64</code>.</li>
</ul>
<div class="fragment">
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="fu">plot</span>(md_2017<span class="sc">$</span>sen_ind, md_2017<span class="sc">$</span>prct_20_64) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-17-1.png" width="960"></p>
</div>
</div>
</div>
</section>
<section id="correlation-cont." class="slide level2">
<h2>Correlation cont.</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">cor</span>(md_2017<span class="sc">$</span>sen_ind, md_2017<span class="sc">$</span>prct_20_64)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6390244</code></pre>
</div>
</div>
<p>We have seen worse.</p>
</section>
<section id="moran-test-on-residuals" class="slide level2">
<h2>Moran test on residuals</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">lm.morantest</span>(lm2, <span class="at">listw =</span> md_2017_w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Global Moran I for regression residuals

data:  
model: lm(formula = mod2, data = md_2017)
weights: md_2017_w

Moran I statistic standard deviate = 7.2984, p-value = 1.456e-13
alternative hypothesis: greater
sample estimates:
Observed Moran I      Expectation         Variance 
     0.267216998     -0.006847098      0.001410110 </code></pre>
</div>
</div>
</section>
<section id="moran-plot-residuals" class="slide level2">
<h2>Moran plot residuals</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">moran.plot</span>(<span class="fu">residuals</span>(lm2), <span class="at">listw =</span> md_2017_w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-20-1.png" width="960" class="r-stretch"><ul>
<li class="fragment">We will use mod2 in the following. We have spatial autocorrelation in the residuals from OLS.</li>
</ul>
</section></section>
<section>
<section id="the-anselin-approach" class="title-slide slide level1 center">
<h1>The Anselin approach</h1>

</section>
<section id="the-anselin-approach-1" class="slide level2">
<h2>The Anselin approach</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># From BurkeyAcademy</span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="fu">lm.LMtests</span>(lm2, <span class="at">listw =</span> md_2017_w, <span class="at">test =</span> <span class="st">"all"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Lagrange multiplier diagnostics for spatial dependence

data:  
model: lm(formula = mod2, data = md_2017)
weights: md_2017_w

LMerr = 49.317, df = 1, p-value = 2.178e-12


    Lagrange multiplier diagnostics for spatial dependence

data:  
model: lm(formula = mod2, data = md_2017)
weights: md_2017_w

LMlag = 35.015, df = 1, p-value = 0.000000003273


    Lagrange multiplier diagnostics for spatial dependence

data:  
model: lm(formula = mod2, data = md_2017)
weights: md_2017_w

RLMerr = 18.191, df = 1, p-value = 0.00001998


    Lagrange multiplier diagnostics for spatial dependence

data:  
model: lm(formula = mod2, data = md_2017)
weights: md_2017_w

RLMlag = 3.8892, df = 1, p-value = 0.0486


    Lagrange multiplier diagnostics for spatial dependence

data:  
model: lm(formula = mod2, data = md_2017)
weights: md_2017_w

SARMA = 53.206, df = 2, p-value = 2.796e-12</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li class="fragment"><p>Both LMerr and LMLag are significant.</p></li>
<li class="fragment"><p>Proceed with RLMlerr and RLMlag.</p></li>
<li class="fragment"><p>Again both are significant.</p></li>
<li class="fragment"><p>So we don´t have a clear conclusion. One might argue that since RLMlag are just marginally significant, SEM is probably the best choice.</p></li>
</ul>
</div>
</div>
<p>For a more thorough discussion see <span class="citation" data-cites="osland2010">Osland (<a href="#/bibliography" role="doc-biblioref" onclick="">2010</a>)</span> and <span class="citation" data-cites="chi2019spatial">Chi and Zhu (<a href="#/bibliography" role="doc-biblioref" onclick="">2019</a>)</span> page 55.</p>
</section></section>
<section>
<section id="the-lesage-approach" class="title-slide slide level1 center">
<h1>The LeSage approach</h1>

</section>
<section id="local-or-global" class="slide level2">
<h2>Local or global?</h2>
<ul>
<li class="fragment"><p>To formally test this we have to use Bayesian modelling. Outside our scope.</p></li>
<li class="fragment"><p>One might argue that a local perspective is best suited for this dataset.</p></li>
<li class="fragment"><p>A change in one of the explanatory variables for one municipality (haugesund) might effect pm2 in this municipality and potentially also change pm2 in neighbouring municipalities (Sveio, Karmøy, Bømlo, Tysvær), but there are scarce reasons to think that these changes will ripple through the whole country (and eventually change pm2 in Hammerfest).</p>
<blockquote>
<p>If one can narrow down the relationship being investigated as reflecting a local spillover situation, then the SDEM model is the only model one needs to estimate. This specification subsumes the SLX and SEM specifications as special cases.<span class="citation" data-cites="lesage2014">(<a href="#/bibliography" role="doc-biblioref" onclick="">LeSage 2014</a>)</span></p>
</blockquote></li>
</ul>
</section>
<section id="local-or-global-cont." class="slide level2">
<h2>Local or global? cont.</h2>
<p>Note that plain OLS is a special case of SDEM. (all spatial autocorrelation coefficients are zero (<span class="math inline">\(\rho = 0, \theta = 0\)</span> and <span class="math inline">\(\lambda =0\)</span>))</p>
<p>Manski (“includes everything”):</p>
<p><span class="math display">\[ {\bf y = \rho W y + X \beta +W X\theta + u\quad u = \lambda Wu + \epsilon}\]</span></p>
</section>
<section id="lesages-2014-5-principles" class="slide level2">
<h2>LeSages (2014) 5 principles</h2>
<ol type="1">
<li class="fragment"><p>Local versus global spillover</p>
<ol type="i">
<li class="fragment"><p>“A resource shared by numerous regions such as a highway (or river) can be one cause of global spillovers.”</p></li>
<li class="fragment"><p>“Global spillover phenomena should be rarer than local spillovers in applied regional science modeling situations, hence the statement: ‘most spatial spillovers are local.’”</p></li>
<li class="fragment"><p>“Global spillover specifications are more difficult to estimate and correct interpretation of estimates from these specifications is more difficult. Because of the interesting theoretical econometric aspects of these specifications, they represent those most studied in the spatial econometrics literature. Still, this does not mean they should be those most frequently used by regional science practitioners.”</p></li>
</ol></li>
<li class="fragment"><p>Only two model specifications relevant for applied work</p>
<ol type="i">
<li class="fragment"><p>SDEM</p></li>
<li class="fragment"><p>SDM</p></li>
</ol></li>
</ol>
</section>
<section id="lesages-2014-5-principles-1" class="slide level2">
<h2>LeSages (2014) 5 principles</h2>
<ol start="3" type="1">
<li class="fragment">Estimation procedures, not only point estimates
<ol type="i">
<li class="fragment"><p>Estimates of dispersion</p></li>
<li class="fragment"><p>Calculate direct/indirect effects</p></li>
</ol></li>
<li class="fragment">“Avoid the temptation for observation-level inference”</li>
<li class="fragment">“Keep the weight matrix simple”</li>
</ol>
</section>
<section id="lesages-2014-recommendations" class="slide level2">
<h2>LeSages (2014) recommendations</h2>
<ul>
<li class="fragment">“Sparse connectivity structures work best”</li>
<li class="fragment">Parameterised decay can give identification problems</li>
<li class="fragment">Do not use multiple weight matrices</li>
<li class="fragment">Do not use non-spatial weight matrices</li>
</ul>
</section>
<section id="local-dgp-data-generating-process" class="slide level2">
<h2>Local DGP (Data Generating Process)</h2>
<p>We decide that the DGP is probably local in our data</p>
<p>We start out with a Spatial Durban Error Model (SDEM) model, i.e.&nbsp;<span class="math inline">\(\rho = 0\)</span> (notation follows <a href="https://spatial.burkeyacademy.com/home">Burkey</a>:</p>
<p>Nested models:</p>
<p>Manskin:</p>
<p><span class="math display">\[{\bf y = \rho W y + X \beta +W X\theta + u\quad u = \lambda Wu + \epsilon}\]</span> SDEM:</p>
<p><span class="math display">\[ \rho = 0:\quad y = {\bf X \beta + W X\theta + u\quad u = \lambda Wu + \epsilon} \]</span></p>
<p>SEM:</p>
<p><span class="math display">\[ \rho = 0, \theta = 0: \quad y = {\bf X \beta  + u\quad u = \lambda Wu + \epsilon} \]</span></p>
<p>SLX:</p>
<p><span class="math display">\[ \rho = 0, \lambda = 0: \quad y = {\bf X \beta  + W X\theta + \epsilon} \]</span></p>
<p>OLS:</p>
<p><span class="math display">\[ \rho = 0, \theta = 0, \lambda = 0: \quad y = {\bf X \beta  + \epsilon} \]</span></p>
<p>The last three models are all restricted versions of SDEM and we can use Likelihood ratios (for spatial linear models) to decide which is the best model (<code>spatialreg::LR.Sarlm()</code> or <code>lmtest::lrtest()</code>, they will give the same answer) .</p>
</section>
<section id="sdem-spatial-durban-error-model-model" class="slide level2">
<h2>SDEM (Spatial Durban Error Model) model</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># Old (Burkey): errorsarlm(mod2, data = md_2017, listw = md_2017_w, etype = "emixed")</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>SDEM <span class="ot">&lt;-</span> <span class="fu">errorsarlm</span>(mod2, <span class="at">data =</span> md_2017, <span class="at">listw =</span> md_2017_w, <span class="at">Durbin =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="regression-report" class="slide level2">
<h2>Regression report</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># Take care. Do NOT interpret the regression coefficients</span></span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="fu">summary</span>(SDEM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:errorsarlm(formula = mod2, data = md_2017, listw = md_2017_w, 
    Durbin = TRUE)

Residuals:
       Min         1Q     Median         3Q        Max 
-0.4571586 -0.0841577  0.0049056  0.0996526  0.5374538 

Type: error 
Coefficients: (asymptotic standard errors) 
                      Estimate   Std. Error z value  Pr(&gt;|z|)
(Intercept)        5.459962672  0.722236361  7.5598 4.041e-14
prct_20_64         0.027171328  0.005813866  4.6735 2.961e-06
inc_bt_9and10      0.026867040  0.002940012  9.1384 &lt; 2.2e-16
spc_k              0.000949083  0.000345221  2.7492  0.005974
sen_ind            0.001692672  0.000152011 11.1352 &lt; 2.2e-16
lag.prct_20_64     0.017090668  0.011868677  1.4400  0.149873
lag.inc_bt_9and10  0.007906567  0.004632381  1.7068  0.087858
lag.spc_k          0.000078155  0.000791456  0.0987  0.921338
lag.sen_ind       -0.000181715  0.000237360 -0.7656  0.443935

Lambda: 0.42445, LR test value: 36.009, p-value: 0.0000000019636
Asymptotic standard error: 0.062357
    z-value: 6.8068, p-value: 9.9791e-12
Wald statistic: 46.333, p-value: 9.9791e-12

Log likelihood: 142.853 for error model
ML residual variance (sigma squared): 0.023464, (sigma: 0.15318)
Number of observations: 329 
Number of parameters estimated: 11 
AIC: -263.71, (AIC for lm: -229.7)</code></pre>
</div>
</div>
</section>
<section id="the-impacts" class="slide level2">
<h2>The impacts</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># The relevant info. for SDEM. Interpret impacts</span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="fu">summary</span>(<span class="fu">impacts</span>(SDEM), <span class="at">zstats =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Impact measures (SDEM, estimable, n):
                    Direct       Indirect       Total
prct_20_64    0.0271713282  0.01709066796 0.044261996
inc_bt_9and10 0.0268670398  0.00790656673 0.034773607
spc_k         0.0009490832  0.00007815519 0.001027238
sen_ind       0.0016926717 -0.00018171458 0.001510957
========================================================
Standard errors:
                    Direct     Indirect        Total
prct_20_64    0.0058138661 0.0118686767 0.0149430539
inc_bt_9and10 0.0029400122 0.0046323806 0.0042956559
spc_k         0.0003452214 0.0007914562 0.0009861918
sen_ind       0.0001520106 0.0002373598 0.0002194918
========================================================
Z-values:
                 Direct    Indirect    Total
prct_20_64     4.673539  1.43998092 2.962045
inc_bt_9and10  9.138411  1.70680422 8.095063
spc_k          2.749201  0.09874859 1.041621
sen_ind       11.135220 -0.76556593 6.883890

p-values:
              Direct       Indirect Total     
prct_20_64    0.0000029605 0.149873 0.003056  
inc_bt_9and10 &lt; 2.22e-16   0.087858 6.6613e-16
spc_k         0.0059741    0.921338 0.297587  
sen_ind       &lt; 2.22e-16   0.443935 5.8240e-12</code></pre>
</div>
</div>
<p>The impacts are reported to show how it is done. One might argue that the impacts could wait until the correct model is decided upon below.</p>
</section>
<section id="moran-plot-sdem-residuals" class="slide level2">
<h2>Moran plot SDEM residuals</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="fu">moran.plot</span>(<span class="fu">residuals</span>(SDEM), <span class="at">listw =</span> md_2017_w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-25-1.png" width="960" class="r-stretch"></section>
<section id="slx-model" class="slide level2">
<h2>SLX model</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>SLX <span class="ot">&lt;-</span> <span class="fu">lmSLX</span>(</span>
<span id="cb42-2"><a href="#cb42-2"></a>  mod2, </span>
<span id="cb42-3"><a href="#cb42-3"></a>  <span class="at">data =</span> md_2017, </span>
<span id="cb42-4"><a href="#cb42-4"></a>  <span class="at">listw =</span> md_2017_w, </span>
<span id="cb42-5"><a href="#cb42-5"></a>  <span class="at">Durbin =</span> <span class="cn">TRUE</span></span>
<span id="cb42-6"><a href="#cb42-6"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">summary</span>(SLX)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = formula(paste("y ~ ", paste(colnames(x)[-1], collapse = "+"))), 
    data = as.data.frame(x), weights = weights)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41882 -0.08986  0.00751  0.09590  0.48144 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        4.5243803  0.5740667   7.881 5.13e-14 ***
prct_20_64         0.0293684  0.0060045   4.891 1.59e-06 ***
inc_bt_9and10      0.0270304  0.0034650   7.801 8.76e-14 ***
spc_k              0.0008658  0.0003574   2.422  0.01597 *  
sen_ind            0.0016788  0.0001799   9.330  &lt; 2e-16 ***
lag.prct_20_64     0.0357609  0.0107963   3.312  0.00103 ** 
lag.inc_bt_9and10  0.0076629  0.0045320   1.691  0.09184 .  
lag.spc_k         -0.0003430  0.0007303  -0.470  0.63891    
lag.sen_ind       -0.0004633  0.0002367  -1.957  0.05117 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1679 on 320 degrees of freedom
Multiple R-squared:  0.803, Adjusted R-squared:  0.7981 
F-statistic: 163.1 on 8 and 320 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="slx-model-cont." class="slide level2">
<h2>SLX model cont.</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="fu">summary</span>(<span class="fu">impacts</span>(SLX), <span class="at">z.values =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Impact measures (SlX, estimable, n-k):
                    Direct      Indirect        Total
prct_20_64    0.0293684472  0.0357608695 0.0651293167
inc_bt_9and10 0.0270304048  0.0076629095 0.0346933144
spc_k         0.0008657653 -0.0003430118 0.0005227535
sen_ind       0.0016787649 -0.0004632674 0.0012154975
========================================================
Standard errors:
                    Direct     Indirect        Total
prct_20_64    0.0060045003 0.0107963186 0.0118891646
inc_bt_9and10 0.0034649565 0.0045320133 0.0030025656
spc_k         0.0003573903 0.0007303328 0.0008350451
sen_ind       0.0001799356 0.0002366776 0.0001615114
========================================================
Z-values:
                Direct   Indirect      Total
prct_20_64    4.891073  3.3123207  5.4780398
inc_bt_9and10 7.801081  1.6908401 11.5545568
spc_k         2.422464 -0.4696651  0.6260184
sen_ind       9.329811 -1.9573772  7.5257702

p-values:
              Direct     Indirect   Total     
prct_20_64    1.0029e-06 0.00092525 4.3006e-08
inc_bt_9and10 6.2172e-15 0.09086736 &lt; 2.22e-16
spc_k         0.015416   0.63859433 0.5313    
sen_ind       &lt; 2.22e-16 0.05030313 5.2403e-14</code></pre>
</div>
</div>
</section>
<section id="spatial-lag-only-prct_20_64-and-sen_ind" class="slide level2">
<h2>Spatial lag only <code>prct_20_64</code> and <code>sen_ind</code>?</h2>
<p>Perhaps spatial lag just for <code>prct_20_64</code> and <code>sen_ind</code> is more appropriate?</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>SLXred <span class="ot">&lt;-</span> <span class="fu">lmSLX</span>(</span>
<span id="cb47-2"><a href="#cb47-2"></a>  mod2, </span>
<span id="cb47-3"><a href="#cb47-3"></a>  <span class="at">data =</span> md_2017, </span>
<span id="cb47-4"><a href="#cb47-4"></a>  <span class="at">listw =</span> md_2017_w, </span>
<span id="cb47-5"><a href="#cb47-5"></a>  <span class="at">Durbin =</span><span class="sc">~</span>prct_20_64 <span class="sc">+</span> sen_ind</span>
<span id="cb47-6"><a href="#cb47-6"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">summary</span>(SLXred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = formula(paste("y ~ ", paste(colnames(x)[-1], collapse = "+"))), 
    data = as.data.frame(x), weights = weights)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.42200 -0.08543  0.00297  0.09024  0.48073 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     4.5543075  0.5672570   8.029 1.87e-14 ***
prct_20_64      0.0299614  0.0059617   5.026 8.34e-07 ***
inc_bt_9and10   0.0313854  0.0022985  13.655  &lt; 2e-16 ***
spc_k           0.0008600  0.0003570   2.409  0.01657 *  
sen_ind         0.0016553  0.0001726   9.590  &lt; 2e-16 ***
lag.prct_20_64  0.0346104  0.0105264   3.288  0.00112 ** 
lag.sen_ind    -0.0003859  0.0002325  -1.659  0.09804 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1682 on 322 degrees of freedom
Multiple R-squared:  0.801, Adjusted R-squared:  0.7973 
F-statistic: 216.1 on 6 and 322 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="slx-residuals" class="slide level2">
<h2>SLX residuals?</h2>
<ul>
<li class="fragment">Testing for spatial autocorrelation in the residuals of the SLX model.</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="fu">lm.morantest</span>(</span>
<span id="cb50-2"><a href="#cb50-2"></a>  SLX, </span>
<span id="cb50-3"><a href="#cb50-3"></a>  <span class="at">listw =</span> md_2017_w, </span>
<span id="cb50-4"><a href="#cb50-4"></a>  <span class="at">alternative =</span> <span class="st">"greater"</span>, </span>
<span id="cb50-5"><a href="#cb50-5"></a>  <span class="at">resfun =</span> residuals, </span>
<span id="cb50-6"><a href="#cb50-6"></a>  <span class="at">naSubset =</span> <span class="cn">TRUE</span></span>
<span id="cb50-7"><a href="#cb50-7"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Global Moran I for regression residuals

data:  
model: lm(formula = formula(paste("y ~ ", paste(colnames(x)[-1],
collapse = "+"))), data = as.data.frame(x), weights = weights)
weights: md_2017_w

Moran I statistic standard deviate = 6.5847, p-value = 2.279e-11
alternative hypothesis: greater
sample estimates:
Observed Moran I      Expectation         Variance 
     0.238535538     -0.008918982      0.001412270 </code></pre>
</div>
</div>
<ul>
<li class="fragment">Plenty of spatial effects in residuals.</li>
</ul>
</section>
<section id="slx-residuals-plot" class="slide level2">
<h2>SLX residuals plot</h2>
<ul>
<li class="fragment">The SLX model leaves lots of spatial autocorrelation in the residuals, as seen in plot below.</li>
</ul>
<div class="fragment">
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="fu">moran.plot</span>(<span class="fu">residuals</span>(SLX), <span class="at">listw =</span> md_2017_w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-32-1.png" width="960"></p>
</div>
</div>
</div>
</section>
<section id="slxred-residuals" class="slide level2">
<h2>SLXred residuals?</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="fu">lm.morantest</span>(</span>
<span id="cb53-2"><a href="#cb53-2"></a>  SLXred, </span>
<span id="cb53-3"><a href="#cb53-3"></a>  <span class="at">listw =</span> md_2017_w, </span>
<span id="cb53-4"><a href="#cb53-4"></a>  <span class="at">alternative =</span> <span class="st">"greater"</span>, </span>
<span id="cb53-5"><a href="#cb53-5"></a>  <span class="at">resfun =</span> residuals, </span>
<span id="cb53-6"><a href="#cb53-6"></a>  <span class="at">naSubset =</span> <span class="cn">TRUE</span></span>
<span id="cb53-7"><a href="#cb53-7"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Global Moran I for regression residuals

data:  
model: lm(formula = formula(paste("y ~ ", paste(colnames(x)[-1],
collapse = "+"))), data = as.data.frame(x), weights = weights)
weights: md_2017_w

Moran I statistic standard deviate = 6.5606, p-value = 2.68e-11
alternative hypothesis: greater
sample estimates:
Observed Moran I      Expectation         Variance 
     0.238643583     -0.007691829      0.001409845 </code></pre>
</div>
</div>
</section>
<section id="slxred-residuals-plot" class="slide level2">
<h2>SLXred residuals plot</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="fu">moran.plot</span>(<span class="fu">residuals</span>(SLX), <span class="at">listw =</span> md_2017_w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-34-1.png" width="960" class="r-stretch"><ul>
<li class="fragment">Not much difference SLX and SLXred</li>
</ul>
</section>
<section id="sem-model" class="slide level2">
<h2>SEM model</h2>
<ul>
<li class="fragment"><strong>S</strong>patial <strong>E</strong>rror <strong>M</strong>odel</li>
</ul>
<div class="fragment">
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="co"># Spatial error model</span></span>
<span id="cb56-2"><a href="#cb56-2"></a><span class="co"># SDEM (Durbin = TRUE), no lagged y only lagged X and u</span></span>
<span id="cb56-3"><a href="#cb56-3"></a><span class="co"># SEM Durbin = FALSE</span></span>
<span id="cb56-4"><a href="#cb56-4"></a>SEM <span class="ot">&lt;-</span> <span class="fu">errorsarlm</span>(mod2, <span class="at">data =</span> md_2017, <span class="at">listw =</span> md_2017_w, <span class="at">Durbin =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="fu">summary</span>(SEM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:errorsarlm(formula = mod2, data = md_2017, listw = md_2017_w, 
    Durbin = FALSE)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.460521 -0.087668  0.005035  0.090322  0.510908 

Type: error 
Coefficients: (asymptotic standard errors) 
                Estimate Std. Error z value    Pr(&gt;|z|)
(Intercept)   6.56625269 0.26173947 25.0870   &lt; 2.2e-16
prct_20_64    0.02397394 0.00528907  4.5327 0.000005823
inc_bt_9and10 0.02958639 0.00267133 11.0755   &lt; 2.2e-16
spc_k         0.00087237 0.00028872  3.0215    0.002516
sen_ind       0.00172460 0.00012859 13.4111   &lt; 2.2e-16

Lambda: 0.45542, LR test value: 44.506, p-value: 2.5356e-11
Asymptotic standard error: 0.060428
    z-value: 7.5366, p-value: 4.8184e-14
Wald statistic: 56.8, p-value: 4.8295e-14

Log likelihood: 139.8287 for error model
ML residual variance (sigma squared): 0.023715, (sigma: 0.154)
Number of observations: 329 
Number of parameters estimated: 7 
AIC: -265.66, (AIC for lm: -223.15)</code></pre>
</div>
</div>
</div>
</section>
<section id="moran-plot-residuals-sem" class="slide level2">
<h2>Moran plot residuals SEM</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="fu">moran.plot</span>(</span>
<span id="cb59-2"><a href="#cb59-2"></a>  <span class="at">x =</span> <span class="fu">residuals</span>(SEM), </span>
<span id="cb59-3"><a href="#cb59-3"></a>  <span class="at">listw =</span> md_2017_w</span>
<span id="cb59-4"><a href="#cb59-4"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-37-1.png" width="960" class="r-stretch"></section>
<section id="selecting-model" class="slide level2">
<h2>Selecting model</h2>
<p>Testing nested models. Since the models we consider is nested we can use a Likelihood ratio test to decide which model to chose.</p>
<p>Note: Above, in the Anselin approach, we used Lagrange multiplier tests. If H0 is true LR, LM and Walds test (a third alternative) will converge asymptotically. See</p>
<p>We have used the LR test below (since its in the <code>spatialreg</code> package).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="co"># H0: model should be restricted to SEM,</span></span>
<span id="cb60-2"><a href="#cb60-2"></a><span class="co"># p &gt; 0,05, can not discard H0. Discard SDEM select SEM</span></span>
<span id="cb60-3"><a href="#cb60-3"></a><span class="co"># Restrict lagged variables to zero. df is number of lagged variables (to be restricted)</span></span>
<span id="cb60-4"><a href="#cb60-4"></a><span class="co"># LR.sarlm moved to spatialreg, now called LR.Sarlm()</span></span>
<span id="cb60-5"><a href="#cb60-5"></a><span class="fu">LR.Sarlm</span>(SDEM, SEM)<span class="co"># used to be spdep::LR.sarlm() now spatialreg::LR.Sarlm()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Likelihood ratio for spatial linear models

data:  
Likelihood ratio = 6.0486, df = 4, p-value = 0.1955
sample estimates:
Log likelihood of SDEM  Log likelihood of SEM 
              142.8530               139.8287 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="co"># Conclusion: Drop SDEM (theta = 0), but marginally since p = 0,064. </span></span>
<span id="cb62-2"><a href="#cb62-2"></a><span class="co"># Go with SEM, Drop spatial effects in X</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li class="fragment">We should restrict <span class="math inline">\(\theta\)</span> to zero. Spatial interaction in Xs not required.</li>
<li class="fragment">Drop SDEM and continue with SEM</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co"># lrtest from the lmtest packages gives the same result.</span></span>
<span id="cb63-2"><a href="#cb63-2"></a><span class="co">#broom::tidy(lmtest::lrtest(SDEM, SEM))</span></span>
<span id="cb63-3"><a href="#cb63-3"></a><span class="co">#lmtest::lrtest(SDEM, SEM)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="should-we-restrict-sem-to-slx" class="slide level2">
<h2>Should we restrict SEM to SLX?</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="co"># p &lt;0,05. Do not restrict. Keep SEM</span></span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="fu">LR.Sarlm</span>(SEM, SLX)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Likelihood ratio for spatial linear models

data:  
Likelihood ratio = 29.961, df = 3, p-value = 0.000001406
sample estimates:
Log likelihood of SEM Log likelihood of SLX 
             139.8287              124.8482 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="co"># or broom::tidy(lmtest::lrtest(SLX, SEM))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>H0: restrict model to SLX, p &lt; 0,05 and we discard H0. We chose SEM over SLX.</p>
<p>Hence we end up with SEM as the best (given that DGP is local) spatial model for this dataset.</p>
<p><span class="math display">\[ \rho = 0, \theta = 0: \quad y = {\bf X \beta  + u\quad u = \lambda Wu + \epsilon} \]</span></p>
</section>
<section id="should-we-restrict-even-more" class="slide level2">
<h2>Should we restrict even more?</h2>
<p>Should we restrict it even more (<span class="math inline">\(\rho = 0, \theta = 0, \lambda = 0\)</span>) to OLS?</p>
<blockquote>
<p>We can use spatialreg::LR.sarlm() to apply a likelihood ratio test between nested models, but here choose lmtest::lrtest(), which gives the same results, preferring models including spatially lagged covariates.</p>
</blockquote>
<p>From R help <code>lmtest::lrtest</code>:</p>
<blockquote>
<p>lrtest is a generic function for carrying out likelihood ratio tests. The default method can be employed for comparing nested (generalized) linear models</p>
</blockquote>
<p>From R help <code>spatialreg::LR.sarlm</code>:</p>
<blockquote>
<p>The LR.Sarlm() function provides a likelihood ratio test for objects for which a logLik() function exists for their class, or for objects of class logLik.</p>
</blockquote>
<p>The two tests give the same results. We go with <code>LR.Sarlm()</code>. Why <span class="citation" data-cites="bivand">(<a href="#/bibliography" role="doc-biblioref" onclick="">E. P. Bivand Roger n.d.</a>)</span> use <code>lrtest()</code> was not clear. Probably because the broom package was not updated to support the <code>spatialreg</code> package (now updated) when chapter was written.</p>
<p>Test the spatial models against OLS.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="co"># Likelihood ratio test</span></span>
<span id="cb67-2"><a href="#cb67-2"></a><span class="co"># SDEM</span></span>
<span id="cb67-3"><a href="#cb67-3"></a><span class="co"># LR1.Sarlm(SDEM)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="co"># Likelihood ratio test</span></span>
<span id="cb68-2"><a href="#cb68-2"></a><span class="co"># SEM</span></span>
<span id="cb68-3"><a href="#cb68-3"></a><span class="fu">LR1.Sarlm</span>(SEM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Likelihood Ratio diagnostics for spatial dependence

data:  
Likelihood ratio = 44.506, df = 1, p-value = 2.536e-11
sample estimates:
Log likelihood of spatial error model           Log likelihood of OLS fit y 
                             139.8287                              117.5756 </code></pre>
</div>
</div>
<p>No, we should not restrict SEM to OLS (H0). Hence we end up with SEM as the best model for the data, given that this a local phenomenon.</p>
</section>
<section id="we-go-with-sem" class="slide level2">
<h2>We go with SEM</h2>
<p>All good?</p>
<p>We can use a Hausman-test to test for omitted variables. The test compares the coefficient estimates from the spatial model (SEM) and OLS model. If no omitted variables the estimates should be similar.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="co"># Spatial Hausman test</span></span>
<span id="cb70-2"><a href="#cb70-2"></a><span class="fu">Hausman.test</span>(SEM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spatial Hausman test (asymptotic)

data:  NULL
Hausman test = 52.496, df = 5, p-value = 4.268e-10</code></pre>
</div>
</div>
<p>Conclusion: There are marked difference between SEM and OLS coefficients. Hence, the Hausman test indicates that we have a problem with omitted variable(s).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="fu">moran.plot</span>(<span class="fu">residuals</span>(SEM), <span class="at">listw =</span> md_2017_w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-43-1.png" width="960" class="r-stretch"><p>Are there other problems like Heteroskedasticity?</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="co"># test for Heteroskedasticity</span></span>
<span id="cb73-2"><a href="#cb73-2"></a><span class="fu">bptest.Sarlm</span>(SEM, <span class="at">studentize =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  
BP = 35.423, df = 4, p-value = 0.0000003803</code></pre>
</div>
</div>
<p>We do have heteroskedasticity! The estimates should be unbiased, but we might underestimate the standard error. Hence we risk accepting as significant variables that in reality are not. However, note that none of the t-values are marginal.</p>
</section>
<section id="are-our-residuals-normal" class="slide level2">
<h2>Are our residuals normal?</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb75-2"><a href="#cb75-2"></a><span class="co"># H0: residuals normal</span></span>
<span id="cb75-3"><a href="#cb75-3"></a><span class="fu">JarqueBeraTest</span>(<span class="fu">residuals</span>(SEM), <span class="at">robust =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Robust Jarque Bera Test

data:  residuals(SEM)
X-squared = 19.847, df = 2, p-value = 0.00004902</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="co"># Conclusion: not normal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The residuals are not normal!</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a> md_2017 <span class="ot">&lt;-</span> md_2017 <span class="sc">%&gt;%</span> </span>
<span id="cb78-2"><a href="#cb78-2"></a>  <span class="fu">mutate</span>(</span>
<span id="cb78-3"><a href="#cb78-3"></a>    <span class="at">SEM_residuals =</span> <span class="fu">residuals</span>(SEM),</span>
<span id="cb78-4"><a href="#cb78-4"></a>    <span class="at">OLS_residuals =</span> <span class="fu">residuals</span>(lm2)</span>
<span id="cb78-5"><a href="#cb78-5"></a>  )</span>
<span id="cb78-6"><a href="#cb78-6"></a><span class="co"># write md_2017 with residuals</span></span>
<span id="cb78-7"><a href="#cb78-7"></a><span class="fu">st_write</span>(<span class="at">obj =</span> md_2017, <span class="at">dsn =</span> <span class="st">"../data/md_2017.gpkg"</span>, <span class="at">driver =</span> <span class="st">"GPKG"</span>, <span class="at">append=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Deleting layer `md_2017' using driver `GPKG'
Writing layer `md_2017' to data source `../data/md_2017.gpkg' using driver `GPKG'
Writing 329 features with 23 fields and geometry type Multi Polygon.</code></pre>
</div>
</div>
<p>We update <code>data/md_2017.gkpkg</code> with the residuals from the SEM and OLS models. This file can then be opened in Geoda and we can do further EDA of the resisuals.</p>
<div class="cell" data-hash="index_cache/revealjs/tmap_plot_7c315ed39c86bd300676735aef6cccb0">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb80-2"><a href="#cb80-2"></a>t1 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(md_2017) <span class="sc">+</span></span>
<span id="cb80-3"><a href="#cb80-3"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb80-4"><a href="#cb80-4"></a>   <span class="fu">tm_polygons</span>(<span class="st">"SEM_residuals"</span>)</span>
<span id="cb80-5"><a href="#cb80-5"></a>t2 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(md_2017) <span class="sc">+</span></span>
<span id="cb80-6"><a href="#cb80-6"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb80-7"><a href="#cb80-7"></a>   <span class="fu">tm_polygons</span>(<span class="st">"OLS_residuals"</span>)</span>
<span id="cb80-8"><a href="#cb80-8"></a><span class="fu">tmap_arrange</span>(t1, t2, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/tmap_plot-1.png" width="960" class="r-stretch"><div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="fu">huxreg</span>(<span class="st">"OLS"</span> <span class="ot">=</span> lm2, <span class="st">"SEM"</span> <span class="ot">=</span> SEM,</span>
<span id="cb81-2"><a href="#cb81-2"></a>       <span class="at">error_format =</span> <span class="st">"({statistic})"</span>,</span>
<span id="cb81-3"><a href="#cb81-3"></a>       <span class="at">note =</span> <span class="st">"{stars}. T-values reported."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-47">
<colgroup><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">OLS</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">SEM</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(Intercept)</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">6.191 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">6.566 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(21.152)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(25.087)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">prct_20_64</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.032 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.024 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(5.331)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(4.533)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">inc_bt_9and10</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.033 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.030 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(14.267)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(11.076)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">spc_k</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.001 **&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.001 **&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(2.812)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(3.021)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">sen_ind</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.002 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.002 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(14.546)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(13.411)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">lambda</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.455 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(7.537)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">N</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">329&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">329&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">R2</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.794&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.830&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">logLik</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">117.576&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">139.829&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">AIC</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-223.151&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-265.657&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th colspan="3" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> *** p &lt; 0.001;  ** p &lt; 0.01;  * p &lt; 0.05. T-values reported.</th></tr>
</tbody></table>

</div>
</div>
</section>
<section id="do-we-have-omitted-variables" class="slide level2">
<h2>Do we have omitted variables?</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(<span class="fu">Hausman.test</span>(SEM))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-48">
<colgroup><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">52.5</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">4.27e-10</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">5</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Spatial Hausman test (asymptotic)</td></tr>
</tbody></table>

</div>
</div>
<p>Without doubt there is something more to this story. What might it be?</p>
</section>
<section id="a-better-model" class="slide level2">
<h2>A “better” model?</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a>mod3 <span class="ot">&lt;-</span> <span class="st">"log_pm2 ~ log_prct_20_64 + log_net_cap_3000k_p + log_sen_ind"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The variable <code>log_prct_20_64</code> is just the natural logarithm of the percentage of population of a working age. The variable <code>log_net_cap_3000k_p</code> the natural logarithm of the percentage of population with a net wealth exceeding NOK 3.000.000.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>lm3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mod3, <span class="at">data =</span> md_2017)</span>
<span id="cb84-2"><a href="#cb84-2"></a><span class="fu">summary</span>(lm3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mod3, data = md_2017)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41498 -0.08067 -0.00378  0.08628  0.68254 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         -4.24750    1.02765  -4.133 4.56e-05 ***
log_prct_20_64       2.28497    0.29799   7.668 2.04e-13 ***
log_net_cap_3000k_p  0.55823    0.02879  19.391  &lt; 2e-16 ***
log_sen_ind          0.47109    0.07677   6.136 2.46e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1553 on 325 degrees of freedom
Multiple R-squared:  0.8288,    Adjusted R-squared:  0.8273 
F-statistic: 524.6 on 3 and 325 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="fu">mctest</span>(lm3, <span class="at">type =</span> <span class="st">"i"</span>, <span class="at">method=</span><span class="st">"VIF"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
imcdiag(mod = mod, method = method, corr = FALSE, vif = vif, 
    tol = tol, conf = conf, cvif = cvif, ind1 = ind1, ind2 = ind2, 
    leamer = leamer, all = all)


 VIF Multicollinearity Diagnostics

                       VIF detection
log_prct_20_64      1.6559         0
log_net_cap_3000k_p 1.8423         0
log_sen_ind         2.4180         0

NOTE:  VIF Method Failed to detect multicollinearity


0 --&gt; COLLINEARITY is not detected by the test

===================================</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a>SEM_mod3 <span class="ot">&lt;-</span> <span class="fu">errorsarlm</span>(mod3, <span class="at">data =</span> md_2017, <span class="at">listw =</span> md_2017_w, <span class="at">Durbin =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="fu">summary</span>(SEM_mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:errorsarlm(formula = mod3, data = md_2017, listw = md_2017_w, 
    Durbin = FALSE)

Residuals:
       Min         1Q     Median         3Q        Max 
-0.3988746 -0.0659741  0.0024313  0.0654742  0.6800960 

Type: error 
Coefficients: (asymptotic standard errors) 
                     Estimate Std. Error z value  Pr(&gt;|z|)
(Intercept)         -2.687507   0.856437 -3.1380  0.001701
log_prct_20_64       1.735017   0.254544  6.8162 9.349e-12
log_net_cap_3000k_p  0.542116   0.031306 17.3167 &lt; 2.2e-16
log_sen_ind          0.578234   0.086140  6.7128 1.910e-11

Lambda: 0.54686, LR test value: 74.573, p-value: &lt; 2.22e-16
Asymptotic standard error: 0.054144
    z-value: 10.1, p-value: &lt; 2.22e-16
Wald statistic: 102.01, p-value: &lt; 2.22e-16

Log likelihood: 185.2578 for error model
ML residual variance (sigma squared): 0.0175, (sigma: 0.13229)
Number of observations: 329 
Number of parameters estimated: 6 
AIC: -358.52, (AIC for lm: -285.94)</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="fu">moran.plot</span>(<span class="fu">residuals</span>(SEM_mod3), <span class="at">listw =</span> md_2017_w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-54-1.png" width="960" class="r-stretch"><div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a><span class="fu">huxreg</span>(<span class="st">"OLS_mod3"</span> <span class="ot">=</span> lm3, <span class="st">"SEM_mod3"</span> <span class="ot">=</span> SEM_mod3, <span class="at">error_format =</span> <span class="st">"({statistic})"</span>, <span class="at">note =</span> <span class="st">"{stars}. T-values reported."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-55">
<colgroup><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">OLS_mod3</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">SEM_mod3</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(Intercept)</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-4.247 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2.688 **&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(-4.133)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(-3.138)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">log_prct_20_64</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.285 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.735 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(7.668)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(6.816)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">log_net_cap_3000k_p</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.558 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.542 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(19.391)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(17.317)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">log_sen_ind</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.471 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.578 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(6.136)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(6.713)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">lambda</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.547 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(10.100)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">N</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">329&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">329&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">R2</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.829&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.875&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">logLik</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">147.971&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">185.258&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">AIC</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-285.943&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-358.516&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th colspan="3" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> *** p &lt; 0.001;  ** p &lt; 0.01;  * p &lt; 0.05. T-values reported.</th></tr>
</tbody></table>

</div>
</div>
</section>
<section id="whats-the-big-problem-with-this-model" class="slide level2">
<h2>What´s the big problem with this model?</h2>
<div class="fragment">
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(md_2017<span class="sc">$</span>log_pm2), <span class="fu">log</span>(md_2017<span class="sc">$</span>net_cap_3000k_p))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-56-1.png" width="960"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="fu">cor</span>(<span class="fu">log</span>(md_2017<span class="sc">$</span>log_pm2), <span class="fu">log</span>(md_2017<span class="sc">$</span>net_cap_3000k_p))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8528894</code></pre>
</div>
</div>
</div>
</section>
<section id="global-dgp" class="slide level2">
<h2>Global DGP</h2>
<p>How we would have analysed this if we though it was a global phenomenon. You should have good arguments to select this track.</p>
</section>
<section id="nested-models" class="slide level2">
<h2>Nested models</h2>
<p>Nested models:</p>
<p>SDM:</p>
<p><span class="math display">\[ \lambda = 0:\quad {\bf y = \rho Wy + X \beta + W X\theta + \epsilon} \]</span></p>
<p>SLX:</p>
<p><span class="math display">\[ \lambda = 0, \rho = 0: \quad {\bf y = X \beta  + W X\theta + \epsilon} \]</span></p>
<p>SAR (Spatial lag):</p>
<p><span class="math display">\[ \lambda = 0, \theta = 0:\quad {\bf y = \rho Wy + X \beta + \epsilon} \]</span></p>
<p>SEM (<span class="math inline">\(\theta = - \rho \beta\)</span>)</p>
<p><span class="math display">\[ \lambda = 0, \theta = -\rho \beta:\quad {\bf y = X \beta  + u,\quad u = \lambda W u + \epsilon}\]</span></p>
<h4 id="ols">OLS:</h4>
<p><span class="math display">\[ \rho = 0, \theta = 0, \lambda = 0: \quad y = {\bf X \beta  + \epsilon} \]</span> ## Estimating the models</p>
</section>
<section id="sdm" class="slide level2">
<h2>SDM:</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a><span class="co"># Old style (Burkey): lagsarlm(mod2, data = md_2017, listw = md_2017_w, type = "mixed")</span></span>
<span id="cb96-2"><a href="#cb96-2"></a>SDM <span class="ot">&lt;-</span> <span class="fu">lagsarlm</span>(mod2, <span class="at">data =</span> md_2017, <span class="at">listw =</span> md_2017_w, <span class="at">Durbin =</span> <span class="cn">TRUE</span>)</span>
<span id="cb96-3"><a href="#cb96-3"></a><span class="co"># Do not interpret coefficient estimates!!!!!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a><span class="co"># be careful</span></span>
<span id="cb97-2"><a href="#cb97-2"></a><span class="fu">summary</span>(SDM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:lagsarlm(formula = mod2, data = md_2017, listw = md_2017_w, Durbin = TRUE)

Residuals:
       Min         1Q     Median         3Q        Max 
-0.4583940 -0.0843224  0.0026429  0.0899973  0.5340799 

Type: mixed 
Coefficients: (asymptotic standard errors) 
                     Estimate  Std. Error z value  Pr(&gt;|z|)
(Intercept)        2.67809841  0.62210440  4.3049 1.671e-05
prct_20_64         0.02568975  0.00548463  4.6839 2.814e-06
inc_bt_9and10      0.02602639  0.00315629  8.2459 2.220e-16
spc_k              0.00087101  0.00032547  2.6762  0.007447
sen_ind            0.00173814  0.00016389 10.6053 &lt; 2.2e-16
lag.prct_20_64     0.01048689  0.01013826  1.0344  0.300955
lag.inc_bt_9and10 -0.00552064  0.00459166 -1.2023  0.229240
lag.spc_k         -0.00052949  0.00066621 -0.7948  0.426738
lag.sen_ind       -0.00098770  0.00023529 -4.1978 2.696e-05

Rho: 0.41917, LR test value: 37.824, p-value: 7.7436e-10
Asymptotic standard error: 0.062316
    z-value: 6.7265, p-value: 1.7379e-11
Wald statistic: 45.246, p-value: 1.7379e-11

Log likelihood: 143.7601 for mixed model
ML residual variance (sigma squared): 0.023364, (sigma: 0.15285)
Number of observations: 329 
Number of parameters estimated: 11 
AIC: -265.52, (AIC for lm: -229.7)
LM test for residual autocorrelation
test value: 3.3921, p-value: 0.065508</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a><span class="fu">summary</span>(<span class="fu">impacts</span>(SDM, <span class="at">listw =</span> md_2017_w, <span class="at">R=</span><span class="dv">1000</span>), <span class="at">zstats =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Impact measures (mixed, exact):
                    Direct      Indirect        Total
prct_20_64    0.0281782979  0.0341061297 0.0622844277
inc_bt_9and10 0.0266573125  0.0086469222 0.0353042347
spc_k         0.0008517659 -0.0002637761 0.0005879898
sen_ind       0.0017078022 -0.0004157873 0.0012920150
========================================================
Simulation results ( variance matrix):
Direct:

Iterations = 1:1000
Thinning interval = 1 
Number of chains = 1 
Sample size per chain = 1000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

                   Mean        SD    Naive SE Time-series SE
prct_20_64    0.0280181 0.0058445 0.000184820    0.000184820
inc_bt_9and10 0.0265255 0.0029375 0.000092891    0.000092891
spc_k         0.0008563 0.0003704 0.000011712    0.000011712
sen_ind       0.0017162 0.0001576 0.000004984    0.000004984

2. Quantiles for each variable:

                   2.5%       25%       50%      75%    97.5%
prct_20_64    0.0160324 0.0241478 0.0280063 0.031990 0.038831
inc_bt_9and10 0.0209177 0.0245514 0.0263943 0.028520 0.032379
spc_k         0.0001407 0.0006174 0.0008522 0.001108 0.001541
sen_ind       0.0014181 0.0016072 0.0017166 0.001822 0.002037

========================================================
Indirect:

Iterations = 1:1000
Thinning interval = 1 
Number of chains = 1 
Sample size per chain = 1000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

                    Mean        SD    Naive SE Time-series SE
prct_20_64     0.0339659 0.0161841 0.000511785    0.000511785
inc_bt_9and10  0.0087898 0.0050672 0.000160240    0.000182010
spc_k         -0.0002419 0.0011520 0.000036429    0.000039680
sen_ind       -0.0004198 0.0002851 0.000009016    0.000008973

2. Quantiles for each variable:

                    2.5%        25%        50%        75%     97.5%
prct_20_64     0.0020574  0.0231985  0.0336305  0.0446912 0.0648830
inc_bt_9and10 -0.0015780  0.0058146  0.0087115  0.0122466 0.0180174
spc_k         -0.0024656 -0.0010192 -0.0001939  0.0005079 0.0019196
sen_ind       -0.0009576 -0.0006043 -0.0004298 -0.0002238 0.0001322

========================================================
Total:

Iterations = 1:1000
Thinning interval = 1 
Number of chains = 1 
Sample size per chain = 1000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

                   Mean        SD    Naive SE Time-series SE
prct_20_64    0.0619839 0.0189711 0.000599918    0.000599918
inc_bt_9and10 0.0353153 0.0048004 0.000151803    0.000151803
spc_k         0.0006144 0.0013790 0.000043607    0.000043607
sen_ind       0.0012964 0.0002563 0.000008104    0.000008104

2. Quantiles for each variable:

                    2.5%        25%       50%      75%    97.5%
prct_20_64     0.0242587  0.0495963 0.0620992 0.074465 0.098872
inc_bt_9and10  0.0259296  0.0320983 0.0355132 0.038369 0.044736
spc_k         -0.0021275 -0.0002773 0.0006635 0.001501 0.003200
sen_ind        0.0008164  0.0011233 0.0013029 0.001466 0.001781

========================================================
Simulated standard errors
                    Direct     Indirect        Total
prct_20_64    0.0058445231 0.0161840500 0.0189710613
inc_bt_9and10 0.0029374597 0.0050672267 0.0048004248
spc_k         0.0003703648 0.0011519953 0.0013789706
sen_ind       0.0001576221 0.0002851123 0.0002562599

Simulated z-values:
                 Direct   Indirect     Total
prct_20_64     4.793905  2.0987240 3.2672892
inc_bt_9and10  9.030067  1.7346452 7.3567028
spc_k          2.312030 -0.2099888 0.4455414
sen_ind       10.887790 -1.4724198 5.0587344

Simulated p-values:
              Direct       Indirect Total     
prct_20_64    0.0000016357 0.035841 0.0010858 
inc_bt_9and10 &lt; 2.22e-16   0.082804 1.8852e-13
spc_k         0.020776     0.833676 0.6559285 
sen_ind       &lt; 2.22e-16   0.140908 4.2205e-07</code></pre>
</div>
</div>
</section>
<section id="sar" class="slide level2">
<h2>SAR:</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>SAR <span class="ot">&lt;-</span> <span class="fu">lagsarlm</span>(mod2, <span class="at">data =</span> md_2017, <span class="at">listw =</span> md_2017_w)</span>
<span id="cb101-2"><a href="#cb101-2"></a><span class="co"># Do not interpret estimates and p values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="co"># be careful</span></span>
<span id="cb102-2"><a href="#cb102-2"></a><span class="fu">summary</span>(SAR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:lagsarlm(formula = mod2, data = md_2017, listw = md_2017_w)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.423991 -0.096486  0.004449  0.105846  0.505091 

Type: lag 
Coefficients: (asymptotic standard errors) 
                Estimate Std. Error z value      Pr(&gt;|z|)
(Intercept)   4.00984776 0.47937122  8.3648     &lt; 2.2e-16
prct_20_64    0.03080525 0.00555618  5.5443 0.00000002951
inc_bt_9and10 0.02628991 0.00240127 10.9483     &lt; 2.2e-16
spc_k         0.00143368 0.00031659  4.5284 0.00000594185
sen_ind       0.00128260 0.00012032 10.6594     &lt; 2.2e-16

Rho: 0.25684, LR test value: 32.235, p-value: 0.000000013663
Asymptotic standard error: 0.045279
    z-value: 5.6725, p-value: 0.000000014076
Wald statistic: 32.177, p-value: 0.000000014076

Log likelihood: 133.693 for lag model
ML residual variance (sigma squared): 0.025569, (sigma: 0.1599)
Number of observations: 329 
Number of parameters estimated: 7 
AIC: -253.39, (AIC for lm: -223.15)
LM test for residual autocorrelation
test value: 12.684, p-value: 0.00036876</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="co"># Look at the impacts</span></span>
<span id="cb104-2"><a href="#cb104-2"></a><span class="fu">impacts</span>(SAR,  <span class="at">listw =</span> md_2017_w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Impact measures (lag, exact):
                   Direct     Indirect       Total
prct_20_64    0.031311751 0.0101401184 0.041451869
inc_bt_9and10 0.026722170 0.0086538109 0.035375981
spc_k         0.001457256 0.0004719234 0.001929179
sen_ind       0.001303683 0.0004221899 0.001725873</code></pre>
</div>
</div>
<p>Illustrations of constant ratio (direct/indirect) for the SAR model. Not a good feature of the model for applied work.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a><span class="fu">impacts</span>(SAR,  <span class="at">listw =</span> md_2017_w)<span class="sc">$</span>direct<span class="sc">/</span><span class="fu">impacts</span>(SAR,  <span class="at">listw =</span> md_2017_w)<span class="sc">$</span>indirect</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]
[1,] 3.087908
[2,] 3.087908
[3,] 3.087908
[4,] 3.087908</code></pre>
</div>
</div>
<p>Impacts with z-values.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a><span class="fu">summary</span>(<span class="fu">impacts</span>(SAR, <span class="at">listw =</span> md_2017_w, <span class="at">R=</span><span class="dv">1000</span>), <span class="at">zstats =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Impact measures (lag, exact):
                   Direct     Indirect       Total
prct_20_64    0.031311751 0.0101401184 0.041451869
inc_bt_9and10 0.026722170 0.0086538109 0.035375981
spc_k         0.001457256 0.0004719234 0.001929179
sen_ind       0.001303683 0.0004221899 0.001725873
========================================================
Simulation results ( variance matrix):
Direct:

Iterations = 1:1000
Thinning interval = 1 
Number of chains = 1 
Sample size per chain = 1000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

                  Mean        SD    Naive SE Time-series SE
prct_20_64    0.031188 0.0059777 0.000189032    0.000189032
inc_bt_9and10 0.026677 0.0023929 0.000075670    0.000071998
spc_k         0.001451 0.0003322 0.000010504    0.000010504
sen_ind       0.001306 0.0001208 0.000003819    0.000003819

2. Quantiles for each variable:

                   2.5%      25%      50%      75%    97.5%
prct_20_64    0.0199658 0.027161 0.031406 0.035197 0.042869
inc_bt_9and10 0.0222928 0.025069 0.026615 0.028377 0.031493
spc_k         0.0008133 0.001229 0.001445 0.001664 0.002087
sen_ind       0.0010443 0.001229 0.001305 0.001384 0.001546

========================================================
Indirect:

Iterations = 1:1000
Thinning interval = 1 
Number of chains = 1 
Sample size per chain = 1000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

                   Mean         SD    Naive SE Time-series SE
prct_20_64    0.0102641 0.00317905 0.000100531    0.000100531
inc_bt_9and10 0.0086769 0.00177715 0.000056198    0.000056198
spc_k         0.0004843 0.00017777 0.000005622    0.000005622
sen_ind       0.0004244 0.00008475 0.000002680    0.000002540

2. Quantiles for each variable:

                   2.5%       25%       50%       75%     97.5%
prct_20_64    0.0052003 0.0079711 0.0100699 0.0123043 0.0170681
inc_bt_9and10 0.0053770 0.0074650 0.0086875 0.0097936 0.0123723
spc_k         0.0001883 0.0003546 0.0004707 0.0005886 0.0008713
sen_ind       0.0002692 0.0003641 0.0004219 0.0004817 0.0005981

========================================================
Total:

Iterations = 1:1000
Thinning interval = 1 
Number of chains = 1 
Sample size per chain = 1000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

                  Mean        SD   Naive SE Time-series SE
prct_20_64    0.041452 0.0084481 0.00026715     0.00026715
inc_bt_9and10 0.035354 0.0029637 0.00009372     0.00009372
spc_k         0.001935 0.0004882 0.00001544     0.00001544
sen_ind       0.001731 0.0001439 0.00000455     0.00000455

2. Quantiles for each variable:

                  2.5%      25%      50%      75%    97.5%
prct_20_64    0.026241 0.035574 0.041427 0.046783 0.057998
inc_bt_9and10 0.029818 0.033359 0.035363 0.037384 0.040920
spc_k         0.001011 0.001601 0.001923 0.002241 0.002946
sen_ind       0.001447 0.001634 0.001726 0.001827 0.002011

========================================================
Simulated standard errors
                    Direct      Indirect        Total
prct_20_64    0.0059777210 0.00317905378 0.0084480855
inc_bt_9and10 0.0023929049 0.00177714840 0.0029637325
spc_k         0.0003321655 0.00017777050 0.0004881885
sen_ind       0.0001207673 0.00008475402 0.0001438768

Simulated z-values:
                 Direct Indirect     Total
prct_20_64     5.217428 3.228651  4.906719
inc_bt_9and10 11.148553 4.882508 11.929001
spc_k          4.366844 2.724129  3.963191
sen_ind       10.818318 5.006986 12.030158

Simulated p-values:
              Direct        Indirect      Total        
prct_20_64    0.00000018142 0.0012438     0.00000092612
inc_bt_9and10 &lt; 2.22e-16    0.00000104745 &lt; 2.22e-16   
spc_k         0.00001260550 0.0064471     0.00007395467
sen_ind       &lt; 2.22e-16    0.00000055289 &lt; 2.22e-16   </code></pre>
</div>
</div>
<p>Note that the simulated z-values and p-values differ somewhat between each run, so only an approximation.</p>
<p>It´s also possible to specify that the spatial interaction is just for some variables.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="co"># Only lag sen_ind</span></span>
<span id="cb110-2"><a href="#cb110-2"></a>SAR_red <span class="ot">&lt;-</span> <span class="fu">lagsarlm</span>(mod2, <span class="at">data =</span> md_2017, <span class="at">listw =</span> md_2017_w, <span class="at">Durbin =</span> <span class="sc">~</span>sen_ind)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="fu">summary</span>(<span class="fu">impacts</span>(SAR_red, <span class="at">listw =</span> md_2017_w, <span class="at">R=</span><span class="dv">1000</span>), <span class="at">zstats =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Impact measures (mixed, exact):
                    Direct      Indirect       Total
prct_20_64    0.0265861539  0.0161990337 0.042785188
inc_bt_9and10 0.0245037707  0.0149302305 0.039434001
spc_k         0.0009822063  0.0005984616 0.001580668
sen_ind       0.0017309676 -0.0002764329 0.001454535
========================================================
Simulation results ( variance matrix):
Direct:

Iterations = 1:1000
Thinning interval = 1 
Number of chains = 1 
Sample size per chain = 1000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

                   Mean        SD    Naive SE Time-series SE
prct_20_64    0.0263813 0.0056651 0.000179145    0.000179145
inc_bt_9and10 0.0245192 0.0023998 0.000075889    0.000075889
spc_k         0.0009673 0.0003341 0.000010565    0.000010565
sen_ind       0.0017376 0.0001454 0.000004599    0.000004599

2. Quantiles for each variable:

                  2.5%       25%       50%      75%    97.5%
prct_20_64    0.015369 0.0224618 0.0265182 0.030105 0.037071
inc_bt_9and10 0.019953 0.0228545 0.0245235 0.026147 0.029183
spc_k         0.000325 0.0007439 0.0009684 0.001180 0.001637
sen_ind       0.001465 0.0016366 0.0017370 0.001834 0.002019

========================================================
Indirect:

Iterations = 1:1000
Thinning interval = 1 
Number of chains = 1 
Sample size per chain = 1000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

                    Mean        SD    Naive SE Time-series SE
prct_20_64     0.0161315 0.0048207 0.000152445    0.000152445
inc_bt_9and10  0.0148733 0.0027696 0.000087582    0.000087582
spc_k          0.0005941 0.0002493 0.000007882    0.000007882
sen_ind       -0.0002786 0.0002024 0.000006399    0.000006399

2. Quantiles for each variable:

                    2.5%        25%        50%        75%    97.5%
prct_20_64     0.0079955  0.0128705  0.0156414  0.0191479 0.026111
inc_bt_9and10  0.0098372  0.0128696  0.0147673  0.0166294 0.020369
spc_k          0.0001833  0.0004192  0.0005763  0.0007352 0.001152
sen_ind       -0.0006853 -0.0004094 -0.0002732 -0.0001416 0.000131

========================================================
Total:

Iterations = 1:1000
Thinning interval = 1 
Number of chains = 1 
Sample size per chain = 1000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

                  Mean        SD    Naive SE Time-series SE
prct_20_64    0.042513 0.0096712 0.000305830    0.000305830
inc_bt_9and10 0.039392 0.0036973 0.000116920    0.000116920
spc_k         0.001561 0.0005617 0.000017761    0.000017761
sen_ind       0.001459 0.0001855 0.000005868    0.000006214

2. Quantiles for each variable:

                  2.5%      25%      50%      75%    97.5%
prct_20_64    0.024586 0.035789 0.042234 0.049079 0.062440
inc_bt_9and10 0.032701 0.036996 0.039117 0.041674 0.047118
spc_k         0.000517 0.001187 0.001552 0.001907 0.002725
sen_ind       0.001069 0.001342 0.001467 0.001586 0.001828

========================================================
Simulated standard errors
                    Direct     Indirect        Total
prct_20_64    0.0056650575 0.0048207244 0.0096711983
inc_bt_9and10 0.0023998343 0.0027695767 0.0036973386
spc_k         0.0003340842 0.0002492560 0.0005616641
sen_ind       0.0001454356 0.0002023675 0.0001855500

Simulated z-values:
                 Direct  Indirect     Total
prct_20_64     4.656845  3.346279  4.395814
inc_bt_9and10 10.217044  5.370227 10.654276
spc_k          2.895379  2.383495  2.779955
sen_ind       11.947898 -1.376711  7.863367

Simulated p-values:
              Direct       Indirect       Total     
prct_20_64    0.0000032109 0.00081904     1.1036e-05
inc_bt_9and10 &lt; 2.22e-16   0.000000078638 &lt; 2.22e-16
spc_k         0.003787     0.01714912     0.0054366 
sen_ind       &lt; 2.22e-16   0.16860147     3.7748e-15</code></pre>
</div>
</div>
</section>
<section id="slx" class="slide level2">
<h2>SLX:</h2>
<p>Estimated above.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a><span class="fu">summary</span>(SLX)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = formula(paste("y ~ ", paste(colnames(x)[-1], collapse = "+"))), 
    data = as.data.frame(x), weights = weights)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41882 -0.08986  0.00751  0.09590  0.48144 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        4.5243803  0.5740667   7.881 5.13e-14 ***
prct_20_64         0.0293684  0.0060045   4.891 1.59e-06 ***
inc_bt_9and10      0.0270304  0.0034650   7.801 8.76e-14 ***
spc_k              0.0008658  0.0003574   2.422  0.01597 *  
sen_ind            0.0016788  0.0001799   9.330  &lt; 2e-16 ***
lag.prct_20_64     0.0357609  0.0107963   3.312  0.00103 ** 
lag.inc_bt_9and10  0.0076629  0.0045320   1.691  0.09184 .  
lag.spc_k         -0.0003430  0.0007303  -0.470  0.63891    
lag.sen_ind       -0.0004633  0.0002367  -1.957  0.05117 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1679 on 320 degrees of freedom
Multiple R-squared:  0.803, Adjusted R-squared:  0.7981 
F-statistic: 163.1 on 8 and 320 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a><span class="fu">impacts</span>(SLX, <span class="at">listw =</span> md_2017_w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Impact measures (SlX, estimable):
                    Direct      Indirect        Total
prct_20_64    0.0293684472  0.0357608695 0.0651293167
inc_bt_9and10 0.0270304048  0.0076629095 0.0346933144
spc_k         0.0008657653 -0.0003430118 0.0005227535
sen_ind       0.0016787649 -0.0004632674 0.0012154975</code></pre>
</div>
</div>
</section>
<section id="selecting-model-1" class="slide level2">
<h2>Selecting model</h2>
<p>Should we restrict to <span class="math inline">\(\theta = 0\)</span>?</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a><span class="fu">LR.Sarlm</span>(SDM, SAR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Likelihood ratio for spatial linear models

data:  
Likelihood ratio = 20.134, df = 4, p-value = 0.0004698
sample estimates:
Log likelihood of SDM Log likelihood of SAR 
             143.7601              133.6930 </code></pre>
</div>
</div>
<p>H0 restrict <span class="math inline">\(\theta\)</span> to 0.</p>
<p>We reject H0, continue with SDM.</p>
<p>Should we restrict with <span class="math inline">\(\rho = 0\)</span>?</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a><span class="fu">LR.Sarlm</span>(SDM, SLX)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Likelihood ratio for spatial linear models

data:  
Likelihood ratio = 37.824, df = 1, p-value = 7.744e-10
sample estimates:
Log likelihood of SDM Log likelihood of SLX 
             143.7601              124.8482 </code></pre>
</div>
</div>
<p>H0 restrict <span class="math inline">\(\rho\)</span> to 0.</p>
<p>We reject H0, continue with SDM.</p>
<p>Should we restrict <span class="math inline">\(\theta = - \rho \beta\)</span>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a><span class="fu">LR.Sarlm</span>(SDM, SEM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Likelihood ratio for spatial linear models

data:  
Likelihood ratio = 7.8628, df = 4, p-value = 0.09673
sample estimates:
Log likelihood of SDM Log likelihood of SEM 
             143.7601              139.8287 </code></pre>
</div>
</div>
<p>Choose SEM (and we know from local analyses that we should not restrict to OLS)</p>
<p>If we skip restrict <span class="math inline">\(\theta = - \rho \beta\)</span>. Should we restrict to OLS.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a><span class="fu">LR.Sarlm</span>(SEM, lm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Likelihood ratio for spatial linear models

data:  
Likelihood ratio = 44.506, df = 1, p-value = 2.536e-11
sample estimates:
Log likelihood of SEM Log likelihood of lm2 
             139.8287              117.5756 </code></pre>
</div>
</div>
<p>Reject H0, we should not restrict to OLS.</p>
</section>
<section id="full-manski" class="slide level2">
<h2>Full Manski</h2>
<p>You should probably stay off this track. See <span class="citation" data-cites="lesage2014">(<a href="#/bibliography" role="doc-biblioref" onclick="">LeSage 2014</a>)</span></p>
<p>There is problems estimating this model (identification problems). The reason why one does not start with this model and then treat SAC, SDM and SDEM as nested models.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a><span class="co"># Old style (Burkey): sacsarlm(mod2, data = md_2017, listw = md_2017_w, type = "sacmixed")</span></span>
<span id="cb125-2"><a href="#cb125-2"></a>MANSKI <span class="ot">&lt;-</span> <span class="fu">sacsarlm</span>(mod2, <span class="at">data =</span> md_2017, <span class="at">listw =</span> md_2017_w, <span class="at">Durbin =</span> <span class="cn">TRUE</span>)</span>
<span id="cb125-3"><a href="#cb125-3"></a><span class="fu">summary</span>(MANSKI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:sacsarlm(formula = mod2, data = md_2017, listw = md_2017_w, Durbin = TRUE)

Residuals:
       Min         1Q     Median         3Q        Max 
-0.4198354 -0.0825496  0.0020849  0.0833636  0.4784596 

Type: sacmixed 
Coefficients: (asymptotic standard errors) 
                     Estimate  Std. Error z value  Pr(&gt;|z|)
(Intercept)        1.50425742  0.63914448  2.3535   0.01860
prct_20_64         0.02293222  0.00548048  4.1843 2.860e-05
inc_bt_9and10      0.02584618  0.00322845  8.0058 1.110e-15
spc_k              0.00086502  0.00031586  2.7386   0.00617
sen_ind            0.00180838  0.00016761 10.7891 &lt; 2.2e-16
lag.prct_20_64     0.00485516  0.01002833  0.4841   0.62828
lag.inc_bt_9and10 -0.01250273  0.00516204 -2.4221   0.01543
lag.spc_k         -0.00075156  0.00058742 -1.2794   0.20074
lag.sen_ind       -0.00137809  0.00024757 -5.5665 2.599e-08

Rho: 0.62666
Asymptotic standard error: 0.099265
    z-value: 6.3131, p-value: 2.7355e-10
Lambda: -0.33341
Asymptotic standard error: 0.17285
    z-value: -1.9289, p-value: 0.053748

LR test value: 54.897, p-value: 4.8638e-10

Log likelihood: 145.0239 for sacmixed model
ML residual variance (sigma squared): 0.02115, (sigma: 0.14543)
Number of observations: 329 
Number of parameters estimated: 12 
AIC: -266.05, (AIC for lm: -223.15)</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a><span class="co"># Old style (Burkey): sacsarlm(mod2, data = md_2017, listw = md_2017_w, type = "sac")</span></span>
<span id="cb127-2"><a href="#cb127-2"></a><span class="co"># No lagged X, just lagged y and u</span></span>
<span id="cb127-3"><a href="#cb127-3"></a>KELEJIAN_PRUCA <span class="ot">&lt;-</span> <span class="fu">sacsarlm</span>(mod2, <span class="at">data =</span> md_2017, <span class="at">listw =</span> md_2017_w, <span class="at">Durbin =</span> <span class="cn">FALSE</span>)</span>
<span id="cb127-4"><a href="#cb127-4"></a><span class="fu">summary</span>(KELEJIAN_PRUCA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
sacsarlm(formula = mod2, data = md_2017, listw = md_2017_w, Durbin = FALSE)

Residuals:
       Min         1Q     Median         3Q        Max 
-0.4587765 -0.0935582  0.0026026  0.0963646  0.5289599 

Type: sac 
Coefficients: (asymptotic standard errors) 
                Estimate Std. Error z value    Pr(&gt;|z|)
(Intercept)   5.59638908 0.64606968  8.6622   &lt; 2.2e-16
prct_20_64    0.02613147 0.00542404  4.8177 0.000001452
inc_bt_9and10 0.02856009 0.00273856 10.4289   &lt; 2.2e-16
spc_k         0.00105297 0.00031362  3.3574   0.0007868
sen_ind       0.00161434 0.00013901 11.6127   &lt; 2.2e-16

Rho: 0.095544
Asymptotic standard error: 0.060718
    z-value: 1.5736, p-value: 0.11559
Lambda: 0.37353
Asymptotic standard error: 0.082757
    z-value: 4.5135, p-value: 0.0000063752

LR test value: 46.779, p-value: 6.9525e-11

Log likelihood: 140.9649 for sac model
ML residual variance (sigma squared): 0.023951, (sigma: 0.15476)
Number of observations: 329 
Number of parameters estimated: 8 
AIC: -265.93, (AIC for lm: -223.15)</code></pre>
</div>
</div>
</section>
<section id="final-question" class="slide level2">
<h2>Final question</h2>
<p>Why not start with the Manski (below called the GNS model) model and use a LR test to decide if SAC, SDM or SDEM is the best nested model?</p>
<p>Good question ;-)</p>
<p>The following quote might give the answer:</p>
<blockquote>
<p>Even though taking the GNS model as point of departure to measure spillovers seems appealing since it contains all possible interaction effects, two major issues are that a formal proof under which conditions the parameters of this model are identified is not available yet (see Section 1) and the problem of overfitting. Even though the parameters are not identified, they can still be estimated. However, they have the tendency either to blow each other up or to become insignificant as a result of which this model does not help to choose among the SDM and SDEM models.<span class="citation" data-cites="halleckvega2015">(<a href="#/bibliography" role="doc-biblioref" onclick="">Halleck Vega and Elhorst 2015</a>)</span> p.&nbsp;347.</p>
</blockquote>
<p>There are several problems with fitting the Manski (GNS) model. Should these be solved the Manski model might be a starting point in the future. For the time being the best we can do is probably to follow <span class="citation" data-cites="lesage2014">(<a href="#/bibliography" role="doc-biblioref" onclick="">LeSage 2014</a>)</span> and</p>
<ul>
<li class="fragment">Don’t bother with SAC</li>
<li class="fragment">Decide if the phenomenon we study is of a local or global character</li>
<li class="fragment">If local start with SDEM, if global start with SDM</li>
<li class="fragment">Use <code>LR.Sarlm()</code> to decide which of the nested models to use</li>
<li class="fragment">Remember to report <em>impacts,</em> not coefficient estimates.</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1"></a><span class="co"># new dwellings</span></span>
<span id="cb129-2"><a href="#cb129-2"></a>mod4 <span class="ot">&lt;-</span> <span class="st">"log_pm2 ~ prct_20_64 + inc_bt_9and10  +  sen_ind + I(sfd_ba_completed + sfd_w2u_ba_completed)"</span></span>
<span id="cb129-3"><a href="#cb129-3"></a>lm4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mod4, <span class="at">data =</span> md_2017)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1"></a><span class="fu">summary</span>(lm4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mod4, data = md_2017)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.48403 -0.10321  0.00623  0.10032  0.53345 

Coefficients:
                                              Estimate  Std. Error t value
(Intercept)                                6.387177798 0.313421930  20.379
prct_20_64                                 0.029999697 0.006078476   4.935
inc_bt_9and10                              0.031585407 0.002304524  13.706
sen_ind                                    0.001502981 0.000112447  13.366
I(sfd_ba_completed + sfd_w2u_ba_completed) 0.000004981 0.000001812   2.749
                                             Pr(&gt;|t|)    
(Intercept)                                   &lt; 2e-16 ***
prct_20_64                                 0.00000128 ***
inc_bt_9and10                                 &lt; 2e-16 ***
sen_ind                                       &lt; 2e-16 ***
I(sfd_ba_completed + sfd_w2u_ba_completed)    0.00631 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1707 on 324 degrees of freedom
Multiple R-squared:  0.7939,    Adjusted R-squared:  0.7913 
F-statistic:   312 on 4 and 324 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1"></a>SDEM_mod4 <span class="ot">&lt;-</span> <span class="fu">errorsarlm</span>(mod4, <span class="at">data =</span> md_2017, <span class="at">listw =</span> md_2017_w, <span class="at">Durbin =</span> <span class="cn">TRUE</span>)</span>
<span id="cb132-2"><a href="#cb132-2"></a><span class="fu">summary</span>(<span class="fu">impacts</span>(SDEM_mod4), <span class="at">zstats =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Impact measures (SDEM, estimable, n):
                                                   Direct        Indirect
prct_20_64                                 0.024959397785  0.016643621634
inc_bt_9and10                              0.026220603474  0.004875123116
sen_ind                                    0.001750268724 -0.000471082348
I(sfd_ba_completed + sfd_w2u_ba_completed) 0.000004612348  0.000005561148
                                                  Total
prct_20_64                                 0.0416030194
inc_bt_9and10                              0.0310957266
sen_ind                                    0.0012791864
I(sfd_ba_completed + sfd_w2u_ba_completed) 0.0000101735
========================================================
Standard errors:
                                                   Direct       Indirect
prct_20_64                                 0.005918134102 0.011778249231
inc_bt_9and10                              0.003011189510 0.004763498651
sen_ind                                    0.000143362464 0.000231312783
I(sfd_ba_completed + sfd_w2u_ba_completed) 0.000001747715 0.000003930684
                                                    Total
prct_20_64                                 0.014729222137
inc_bt_9and10                              0.004549428099
sen_ind                                    0.000223008497
I(sfd_ba_completed + sfd_w2u_ba_completed) 0.000004845399
========================================================
Z-values:
                                              Direct  Indirect    Total
prct_20_64                                  4.217444  1.413081 2.824523
inc_bt_9and10                               8.707723  1.023433 6.835085
sen_ind                                    12.208696 -2.036560 5.736043
I(sfd_ba_completed + sfd_w2u_ba_completed)  2.639073  1.414804 2.099620

p-values:
                                           Direct      Indirect Total     
prct_20_64                                 0.000024709 0.157632 0.0047351 
inc_bt_9and10                              &lt; 2.22e-16  0.306103 8.1957e-12
sen_ind                                    &lt; 2.22e-16  0.041694 9.6914e-09
I(sfd_ba_completed + sfd_w2u_ba_completed) 0.0083133   0.157126 0.0357623 </code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1"></a>SEM_mod4 <span class="ot">&lt;-</span> <span class="fu">errorsarlm</span>(mod4, <span class="at">data =</span> md_2017, <span class="at">listw =</span> md_2017_w, <span class="at">Durbin =</span> <span class="cn">FALSE</span>)</span>
<span id="cb134-2"><a href="#cb134-2"></a><span class="fu">summary</span>(SEM_mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:errorsarlm(formula = mod4, data = md_2017, listw = md_2017_w, 
    Durbin = FALSE)

Residuals:
       Min         1Q     Median         3Q        Max 
-0.4638081 -0.0921883  0.0038205  0.0919993  0.5023677 

Type: error 
Coefficients: (asymptotic standard errors) 
                                               Estimate   Std. Error z value
(Intercept)                                6.7015322967 0.2814504975 23.8107
prct_20_64                                 0.0224038565 0.0054991334  4.0741
inc_bt_9and10                              0.0292077896 0.0026677847 10.9483
sen_ind                                    0.0017287275 0.0001295926 13.3397
I(sfd_ba_completed + sfd_w2u_ba_completed) 0.0000040784 0.0000016145  2.5261
                                            Pr(&gt;|z|)
(Intercept)                                &lt; 2.2e-16
prct_20_64                                 0.0000462
inc_bt_9and10                              &lt; 2.2e-16
sen_ind                                    &lt; 2.2e-16
I(sfd_ba_completed + sfd_w2u_ba_completed)   0.01153

Lambda: 0.44751, LR test value: 42.147, p-value: 8.4683e-11
Asymptotic standard error: 0.06093
    z-value: 7.3446, p-value: 2.065e-13
Wald statistic: 53.943, p-value: 2.0639e-13

Log likelihood: 138.4757 for error model
ML residual variance (sigma squared): 0.02396, (sigma: 0.15479)
Number of observations: 329 
Number of parameters estimated: 7 
AIC: -262.95, (AIC for lm: -222.8)</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1"></a><span class="fu">moran.plot</span>(<span class="fu">residuals</span>(SEM_mod4), <span class="at">listw =</span> md_2017_w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-80-1.png" width="960" class="r-stretch"><div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1"></a><span class="fu">moran</span>(<span class="fu">residuals</span>(SEM_mod4), <span class="at">listw =</span> md_2017_w, <span class="at">n =</span> <span class="fu">length</span>(md_2017_nb), <span class="at">S0 =</span> <span class="fu">Szero</span>(md_2017_w))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$I
[1] -0.01430735

$K
[1] 3.788702</code></pre>
</div>
</div>
<p>Morans I for the residuals are now slightly negative (-0.01434). The kurtosis of the residuals is 3.8, compared to 3.0 for a normal distribution, so the distribution of residuals are slightly leptokurtic. Hence more outliers that if they were normaly distributed.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1"></a><span class="fu">JarqueBeraTest</span>(<span class="fu">residuals</span>(SEM_mod4), <span class="at">robust =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Robust Jarque Bera Test

data:  residuals(SEM_mod4)
X-squared = 13.335, df = 2, p-value = 0.001272</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1"></a>SLX_mod4 <span class="ot">&lt;-</span> <span class="fu">lmSLX</span>(mod4, <span class="at">data =</span> md_2017, <span class="at">listw =</span> md_2017_w, <span class="at">Durbin =</span> <span class="cn">TRUE</span>)</span>
<span id="cb141-2"><a href="#cb141-2"></a><span class="fu">summary</span>(SLX_mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = formula(paste("y ~ ", paste(colnames(x)[-1], collapse = "+"))), 
    data = as.data.frame(x), weights = weights)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40527 -0.09317  0.00553  0.10366  0.48804 

Coefficients:
                                                   Estimate   Std. Error
(Intercept)                                     4.940435659  0.603180867
prct_20_64                                      0.027048664  0.006133710
inc_bt_9and10                                   0.026259939  0.003506692
sen_ind                                         0.001741089  0.000168758
I.sfd_ba_completed...sfd_w2u_ba_completed.      0.000004501  0.000001817
lag.prct_20_64                                  0.033881537  0.010768718
lag.inc_bt_9and10                               0.004932595  0.004618570
lag.sen_ind                                    -0.000698463  0.000226843
lag.I.sfd_ba_completed...sfd_w2u_ba_completed.  0.000004644  0.000003633
                                               t value Pr(&gt;|t|)    
(Intercept)                                      8.191 6.28e-15 ***
prct_20_64                                       4.410 1.41e-05 ***
inc_bt_9and10                                    7.489 6.83e-13 ***
sen_ind                                         10.317  &lt; 2e-16 ***
I.sfd_ba_completed...sfd_w2u_ba_completed.       2.477  0.01376 *  
lag.prct_20_64                                   3.146  0.00181 ** 
lag.inc_bt_9and10                                1.068  0.28633    
lag.sen_ind                                     -3.079  0.00226 ** 
lag.I.sfd_ba_completed...sfd_w2u_ba_completed.   1.278  0.20215    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1675 on 320 degrees of freedom
Multiple R-squared:  0.8039,    Adjusted R-squared:  0.799 
F-statistic:   164 on 8 and 320 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1"></a><span class="fu">LR.Sarlm</span>(SDEM_mod4, SEM_mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Likelihood ratio for spatial linear models

data:  
Likelihood ratio = 7.1726, df = 4, p-value = 0.127
sample estimates:
Log likelihood of SDEM_mod4  Log likelihood of SEM_mod4 
                   142.0620                    138.4757 </code></pre>
</div>
</div>
<p>H0 can not be discarded and we should restrict SDEM to SEM, i.e.&nbsp;we should <em>not</em> restrict $$ to zero.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1"></a><span class="fu">LR.Sarlm</span>(SDEM_mod4, SLX_mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Likelihood ratio for spatial linear models

data:  
Likelihood ratio = 32.981, df = 1, p-value = 0.000000009308
sample estimates:
Log likelihood of SDEM_mod4  Log likelihood of SLX_mod4 
                   142.0620                    125.5718 </code></pre>
</div>
</div>
<p>H0 can be discarded and we should <em>not</em> restrict SDEM to SLX, i.e.&nbsp;we should restrict $$ to zero.</p>
<p>Should we restrict further, i.e. SEM to OLS?</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1"></a><span class="co"># H0 restrict SEM to OLS</span></span>
<span id="cb147-2"><a href="#cb147-2"></a><span class="fu">LR.Sarlm</span>(SEM_mod4, lm4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Likelihood ratio for spatial linear models

data:  
Likelihood ratio = 42.147, df = 1, p-value = 8.468e-11
sample estimates:
Log likelihood of SEM_mod4      Log likelihood of lm4 
                  138.4757                   117.4025 </code></pre>
</div>
</div>
<p>H0 can be discarded and we should <em>not</em> restrict SEM further to OLS.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1"></a><span class="co">#siste</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="bibliography" class="slide level2 smaller scrollable">
<h2>Bibliography</h2>

<div class="footer footer-default">
<p><a href="../../index.html">MSB205</a></p>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-zotero-1390" class="csl-entry" role="doc-biblioentry">
n.d. <a href="https://hdl.handle.net/11250/2732299">https://hdl.handle.net/11250/2732299</a>.
</div>
<div id="ref-aarland2015" class="csl-entry" role="doc-biblioentry">
Aarland, Kristin, Liv Aileen Osland, and Arnstein Gjestland. 2015a. <span>“Do <span class="nocase">Area-based Intervention Programs Affect House Prices</span>? <span class="nocase">A Quasi-experimental Approach</span>.”</span> In.
</div>
<div id="ref-aarland2015a" class="csl-entry" role="doc-biblioentry">
———. 2015b. <span>“Do <span class="nocase">Area-based Intervention Programs Affect House Prices</span>? <span class="nocase">A Quasi-experimental Approach</span>.”</span> In.
</div>
<div id="ref-aarland2016" class="csl-entry" role="doc-biblioentry">
———. 2016. <span>“Do <span>Area-Based Intervention Programs Affect House Prices</span>? <span class="nocase">A Quasi-experimental Approach</span>.”</span> In.
</div>
<div id="ref-aarland2017" class="csl-entry" role="doc-biblioentry">
———. 2017. <span>“Do Area-Based Intervention Programs Affect House Prices? <span>A</span> Quasi-Experimental Approach.”</span> <em>Journal of Housing Economics</em> 37: 67–83. <a href="http://www.sciencedirect.com/science/journal/10511377">http://www.sciencedirect.com/science/journal/10511377</a>.
</div>
<div id="ref-allaire2022" class="csl-entry" role="doc-biblioentry">
Allaire, JJ, Yihui Xie, Jonathan McPherson, Javier Luraschi, Kevin Ushey, Aron Atkins, Hadley Wickham, Joe Cheng, Winston Chang, and Richard Iannone. 2022. <em>Rmarkdown: <span>Dynamic</span> Documents for <span>R</span></em>. Manual. <a href="https://github.com/rstudio/rmarkdown">https://github.com/rstudio/rmarkdown</a>.
</div>
<div id="ref-bivand" class="csl-entry" role="doc-biblioentry">
Bivand, Edzer Pebesma, Roger. n.d. <em>Spatial <span>Data Science</span></em>. Accessed May 12, 2021. <a href="https://keen-swartz-3146c4.netlify.app/index.html">https://keen-swartz-3146c4.netlify.app/index.html</a>.
</div>
<div id="ref-spdep2022" class="csl-entry" role="doc-biblioentry">
Bivand, Roger. 2022a. <span>“R Packages for Analyzing Spatial Data: A Comparative Case Study with Areal Data.”</span> <em>Geographical Analysis</em> 54 (3): 488–518. <a href="https://doi.org/10.1111/gean.12319">https://doi.org/10.1111/gean.12319</a>.
</div>
<div id="ref-R-spdep" class="csl-entry" role="doc-biblioentry">
———. 2022b. <em>Spdep: Spatial Dependence: Weighting Schemes, Statistics</em>. <a href="https://CRAN.R-project.org/package=spdep">https://CRAN.R-project.org/package=spdep</a>.
</div>
<div id="ref-sp2013" class="csl-entry" role="doc-biblioentry">
Bivand, Roger S., Edzer Pebesma, and Virgilio Gomez-Rubio. 2013a. <em>Applied Spatial Data Analysis with <span>R</span>, Second Edition</em>. Springer, NY. <a href="https://asdar-book.org/">https://asdar-book.org/</a>.
</div>
<div id="ref-spatialreg2013b" class="csl-entry" role="doc-biblioentry">
———. 2013b. <em>Applied Spatial Data Analysis with <span>R</span>, Second Edition</em>. Springer, NY. <a href="https://asdar-book.org/">https://asdar-book.org/</a>.
</div>
<div id="ref-spdep2013" class="csl-entry" role="doc-biblioentry">
———. 2013c. <em>Applied Spatial Data Analysis with <span>R</span>, Second Edition</em>. Springer, NY. <a href="https://asdar-book.org/">https://asdar-book.org/</a>.
</div>
<div id="ref-spatialreg2013a" class="csl-entry" role="doc-biblioentry">
Bivand, Roger, Jan Hauke, and Tomasz Kossowski. 2013. <span>“Computing the Jacobian in Gaussian Spatial Autoregressive Models: An Illustrated Comparison of Available Methods.”</span> <em>Geographical Analysis</em> 45 (2): 150–79. <a href="https://doi.org/10.1111/gean.12008">https://doi.org/10.1111/gean.12008</a>.
</div>
<div id="ref-spatialreg2021a" class="csl-entry" role="doc-biblioentry">
Bivand, Roger, Giovanni Millo, and Gianfranco Piras. 2021. <span>“A Review of Software for Spatial Econometrics in <span>R</span>.”</span> <em>Mathematics</em> 9 (11). <a href="https://doi.org/10.3390/math9111276">https://doi.org/10.3390/math9111276</a>.
</div>
<div id="ref-spatialreg2015a" class="csl-entry" role="doc-biblioentry">
Bivand, Roger, and Gianfranco Piras. 2015. <span>“Comparing Implementations of Estimation Methods for Spatial Econometrics.”</span> <em>Journal of Statistical Software</em> 63 (18): 1–36. <a href="https://doi.org/10.18637/jss.v063.i18">https://doi.org/10.18637/jss.v063.i18</a>.
</div>
<div id="ref-R-spatialreg" class="csl-entry" role="doc-biblioentry">
———. 2022. <em>Spatialreg: Spatial Regression Analysis</em>. <a href="https://CRAN.R-project.org/package=spatialreg">https://CRAN.R-project.org/package=spatialreg</a>.
</div>
<div id="ref-spdep2018" class="csl-entry" role="doc-biblioentry">
Bivand, Roger, and David W. S. Wong. 2018. <span>“Comparing Implementations of Global and Local Indicators of Spatial Association.”</span> <em>TEST</em> 27 (3): 716–48. <a href="https://doi.org/10.1007/s11749-018-0599-x">https://doi.org/10.1007/s11749-018-0599-x</a>.
</div>
<div id="ref-chi2019spatial" class="csl-entry" role="doc-biblioentry">
Chi, G., and J. Zhu. 2019. <em>Spatial Regression Models for the Social Sciences</em>. Advanced Quantitative Techniques in the Social Sciences. <span>SAGE Publications</span>. <a href="https://books.google.no/books?id=zHGkvwEACAAJ">https://books.google.no/books?id=zHGkvwEACAAJ</a>.
</div>
<div id="ref-2011" class="csl-entry" role="doc-biblioentry">
<span>“Definition of Peer-Reviewed Scientific Journal - <span>NCI Dictionary</span> of <span>Cancer Terms</span> - <span>NCI</span>.”</span> 02/02/2011 - 07:00. nciAppModulePage. 02/02/2011 - 07:00. <a href="https://www.cancer.gov/publications/dictionaries/cancer-terms/def/peer-reviewed-scientific-journal">https://www.cancer.gov/publications/dictionaries/cancer-terms/def/peer-reviewed-scientific-journal</a>.
</div>
<div id="ref-GSS2022" class="csl-entry" role="doc-biblioentry">
<span>“Dependency and Reproducibility – <span>GSS</span>.”</span> n.d. Accessed September 12, 2022. <a href="https://gss.civilservice.gov.uk/reproducible-analytical-pipelines/dependency-and-reproducibility/">https://gss.civilservice.gov.uk/reproducible-analytical-pipelines/dependency-and-reproducibility/</a>.
</div>
<div id="ref-epskamp2019" class="csl-entry" role="doc-biblioentry">
Epskamp, Sacha. 2019. <span>“Reproducibility and <span>Replicability</span> in a <span>Fast-Paced Methodological World</span>.”</span> <em>Advances in Methods and Practices in Psychological Science</em> 2 (May): 251524591984742. <a href="https://doi.org/10.1177/2515245919847421">https://doi.org/10.1177/2515245919847421</a>.
</div>
<div id="ref-gjestland2010" class="csl-entry" role="doc-biblioentry">
Gjestland, Arnstein, David Philip McArthur, Liv Aileen Osland, and Inge Thorsen. 2010a. <span>“Relationships Between Housing Prices and Commuting Flows.”</span> In.
</div>
<div id="ref-gjestland2010a" class="csl-entry" role="doc-biblioentry">
———. 2010b. <span>“Relationships Between Housing Prices and Commuting Flows.”</span> In.
</div>
<div id="ref-gjestland2011" class="csl-entry" role="doc-biblioentry">
———. 2011. <span>“A Bridge over Troubled Waters: <span>Valuing</span> Accessibility Effects of a New Bridge.”</span> In.
</div>
<div id="ref-gjestland2012" class="csl-entry" role="doc-biblioentry">
———. 2012. <span>“A Bridge over Troubled Waters: <span>Valuing</span> Accessibility Effects of a New Bridge.”</span> <em>Accessibility Analysis and Transport Planning: Challenges for Europe and North America</em>.
</div>
<div id="ref-gjestland2014" class="csl-entry" role="doc-biblioentry">
———. 2014. <span>“The Suitability of Hedonic Models for Cost-Benefit Analysis: <span>EVIDENCE</span> from Commuting Flows.”</span> <em>Transportation Research Part A: Policy and Practice</em> 61: 136–51. <a href="http://www.sciencedirect.com/science/journal/09658564">http://www.sciencedirect.com/science/journal/09658564</a>.
</div>
<div id="ref-gjestland2011a" class="csl-entry" role="doc-biblioentry">
Gjestland, Arnstein, David Philip McArthur, Inge Thorsen, and Liv Aileen Osland. 2011. <span>“Alternative Methods for Quantifying Commuting-Related Benefits of New Transport Infrastructure.”</span> In.
</div>
<div id="ref-gjestland2010b" class="csl-entry" role="doc-biblioentry">
Gjestland, Arnstein, Liv Osland, David McArthur, and Inge Thorsen. 2010. <span>“A Bridge over Troubled Waters: <span>Valuing</span> Accessibility Effects of a New Bridge.”</span> In.
</div>
<div id="ref-gjestland2020" class="csl-entry" role="doc-biblioentry">
Gjestland, Arnstein, Liv Osland, and Inge Thorsen. 2020. <span>“Measures of Labour Market Accessibility. <span>What</span> Can We Learn from Observed Commuting Patterns?”</span> <em>REGION</em> 7 (1): 49–70. <a href="http://region.wu.ac.at/">http://region.wu.ac.at/</a>.
</div>
<div id="ref-gjestland2006" class="csl-entry" role="doc-biblioentry">
Gjestland, Arnstein, Inge Heldal Thorsen, and Jan Ub�e. 2006. <span>“Some Aspects on the Intraregional Spatial Distribution of Local Sector Activities.”</span> <em>The Annals of Regional Science</em> 40: 559–82. <a href="http://www.springerlink.com/?MUD=MP">http://www.springerlink.com/?MUD=MP</a>.
</div>
<div id="ref-gjestland2000" class="csl-entry" role="doc-biblioentry">
Gjestland, Arnstein, Inge Thorsen, and Jan Ub�e. 2000. <span>“Some Aspects on the Intraregional Spatial Distribution of Local Sector Activities.”</span> In.
</div>
<div id="ref-grolemund2017" class="csl-entry" role="doc-biblioentry">
Grolemund, Garrett, and Hadley Wickham. 2017. <em>R for <span>Data Science</span>: <span>Import</span>, <span>Tidy</span>, <span>Transform</span>, <span>Visualize</span>, and <span>Model Data</span></em>. 1st edition. <span>Sebastopol, CA</span>: <span>O’Reilly Media</span>.
</div>
<div id="ref-Grossenbacher2022" class="csl-entry" role="doc-biblioentry">
Grossenbacher, Timo. n.d. <span>“A (Truly) Reproducible <span>R</span> Workflow.”</span> Accessed September 12, 2022. <a href="https://timogrossenbacher.ch/2017/07/a-truly-reproducible-r-workflow/">https://timogrossenbacher.ch/2017/07/a-truly-reproducible-r-workflow/</a>.
</div>
<div id="ref-guidotti2020" class="csl-entry" role="doc-biblioentry">
Guidotti, Emanuele, and David Ardia. 2020. <span>“<span>COVID-19</span> Data Hub.”</span> <em>Journal of Open Source Software</em> 5 (51): 2376. <a href="https://doi.org/10.21105/joss.02376">https://doi.org/10.21105/joss.02376</a>.
</div>
<div id="ref-halleckvega2015" class="csl-entry" role="doc-biblioentry">
Halleck Vega, Solmaria, and J. Paul Elhorst. 2015. <span>“<span>THE SLX MODEL</span>.”</span> <em>Journal of Regional Science</em> 55 (3): 339–63. <a href="https://doi.org/10.1111/jors.12188">https://doi.org/10.1111/jors.12188</a>.
</div>
<div id="ref-R-huxtable" class="csl-entry" role="doc-biblioentry">
Hugh-Jones, David. 2022. <em>Huxtable: Easily Create and Style Tables for LaTeX, HTML and Other Formats</em>. <a href="https://hughjonesd.github.io/huxtable/">https://hughjonesd.github.io/huxtable/</a>.
</div>
<div id="ref-judge2004" class="csl-entry" role="doc-biblioentry">
Judge, Timothy A., and Daniel M. Cable. 2004. <span>“The <span>Effect</span> of <span>Physical Height</span> on <span>Workplace Success</span> and <span>Income</span>: <span>Preliminary Test</span> of a <span>Theoretical Model</span>.”</span> <em>Journal of Applied Psychology</em> 89 (3): 428–41. <a href="https://doi.org/10.1037/0021-9010.89.3.428">https://doi.org/10.1037/0021-9010.89.3.428</a>.
</div>
<div id="ref-lander2017" class="csl-entry" role="doc-biblioentry">
Lander, Jared. 2017. <em>R for <span>Everyone</span>: <span>Advanced Analytics</span> and <span>Graphics</span></em>. 2nd edition. <span>Boston</span>: <span>Addison-Wesley Professional</span>.
</div>
<div id="ref-R-PxWebApiData" class="csl-entry" role="doc-biblioentry">
Langsrud, Øyvind, and Jan Bruusgaard. 2021. <em>PxWebApiData: PX-Web Data by API</em>. <a href="https://github.com/statisticsnorway/PxWebApiData">https://github.com/statisticsnorway/PxWebApiData</a>.
</div>
<div id="ref-lesage2014" class="csl-entry" role="doc-biblioentry">
LeSage, James P. 2014. <span>“What <span>Regional Scientists Need</span> to <span>Know About Spatial Econometrics</span>.”</span> SSRN scholarly paper ID 2420725. <span>Rochester, NY</span>: <span>Social Science Research Network</span>. <a href="https://doi.org/10.2139/ssrn.2420725">https://doi.org/10.2139/ssrn.2420725</a>.
</div>
<div id="ref-nordvik2014" class="csl-entry" role="doc-biblioentry">
Nordvik, Viggo, Liv Aileen Osland, and Arnstein Gjestland. 2014a. <span>“Putting a Price on Your Neighbour.”</span> In.
</div>
<div id="ref-nordvik2014a" class="csl-entry" role="doc-biblioentry">
———. 2014b. <span>“Putting a Price on Your Neighbour.”</span> In.
</div>
<div id="ref-RRT2022" class="csl-entry" role="doc-biblioentry">
Ooi, Hong, and Vries, Andrie de. n.d. <em>0.1 <span>The Reproducible R Toolkit</span> (<span>RRT</span>)</em>. Accessed September 12, 2022. <a href="https://cran.r-project.org/web/packages/checkpoint/vignettes/checkpoint.html">https://cran.r-project.org/web/packages/checkpoint/vignettes/checkpoint.html</a>.
</div>
<div id="ref-osland2010" class="csl-entry" role="doc-biblioentry">
Osland, Liv. 2010. <span>“An Application of Spatial Econometrics in Relation to Hedonic House Price Modeling.”</span> <em>Journal of Real Estate Research</em> 32 (July): 289–320.
</div>
<div id="ref-sf2018" class="csl-entry" role="doc-biblioentry">
Pebesma, Edzer. 2018. <span>“<span class="nocase">Simple Features for R: Standardized Support for Spatial Vector Data</span>.”</span> <em><span>The R Journal</span></em> 10 (1): 439–46. <a href="https://doi.org/10.32614/RJ-2018-009">https://doi.org/10.32614/RJ-2018-009</a>.
</div>
<div id="ref-R-sf" class="csl-entry" role="doc-biblioentry">
———. 2022. <em>Sf: Simple Features for r</em>. <a href="https://CRAN.R-project.org/package=sf">https://CRAN.R-project.org/package=sf</a>.
</div>
<div id="ref-sp2005" class="csl-entry" role="doc-biblioentry">
Pebesma, Edzer J., and Roger S. Bivand. 2005. <span>“Classes and Methods for Spatial Data in <span>R</span>.”</span> <em>R News</em> 5 (2): 9–13. <a href="https://CRAN.R-project.org/doc/Rnews/">https://CRAN.R-project.org/doc/Rnews/</a>.
</div>
<div id="ref-R-sp" class="csl-entry" role="doc-biblioentry">
Pebesma, Edzer, and Roger Bivand. 2022. <em>Sp: Classes and Methods for Spatial Data</em>. <a href="https://CRAN.R-project.org/package=sp">https://CRAN.R-project.org/package=sp</a>.
</div>
<div id="ref-zotero-1387" class="csl-entry" role="doc-biblioentry">
<span>“Quarto - <span>About Quarto</span>.”</span> n.d. Accessed September 26, 2022. <a href="https://quarto.org/about.html">https://quarto.org/about.html</a>.
</div>
<div id="ref-R-broom" class="csl-entry" role="doc-biblioentry">
Robinson, David, Alex Hayes, and Simon Couch. 2022. <em>Broom: Convert Statistical Objects into Tidy Tibbles</em>. <a href="https://CRAN.R-project.org/package=broom">https://CRAN.R-project.org/package=broom</a>.
</div>
<div id="ref-NAP25303" class="csl-entry" role="doc-biblioentry">
Sciences, National Academies of, Engineering, and Medicine. 2019. <em>Reproducibility and Replicability in Science</em>. <span>Washington, DC</span>: <span>The National Academies Press</span>. <a href="https://doi.org/10.17226/25303">https://doi.org/10.17226/25303</a>.
</div>
<div id="ref-sirisilla2022" class="csl-entry" role="doc-biblioentry">
Sirisilla, Shrutika. 2022. <span>“Top 5 <span>Factors Affecting Reproducibility</span> in <span>Research</span>.”</span> <span>Enago Academy</span>. March 31, 2022. <a href="https://www.enago.com/academy/top-5-factors-affecting-reproducibility-in-scientific-research/">https://www.enago.com/academy/top-5-factors-affecting-reproducibility-in-scientific-research/</a>.
</div>
<div id="ref-tmap2018" class="csl-entry" role="doc-biblioentry">
Tennekes, Martijn. 2018. <span>“<span class="nocase">tmap</span>: Thematic Maps in <span>R</span>.”</span> <em>Journal of Statistical Software</em> 84 (6): 1–39. <a href="https://doi.org/10.18637/jss.v084.i06">https://doi.org/10.18637/jss.v084.i06</a>.
</div>
<div id="ref-R-tmap" class="csl-entry" role="doc-biblioentry">
———. 2022. <em>Tmap: Thematic Maps</em>. <a href="https://github.com/r-tmap/tmap">https://github.com/r-tmap/tmap</a>.
</div>
<div id="ref-thorsen2006" class="csl-entry" role="doc-biblioentry">
Thorsen, Inge, Jan Ub�e, and Arnstein Gjestland. 2006. <span>“Some Aspects of the Intraregional Spatial Distribution of Local Sector Activities.”</span> <em>The Annals of Regional Science</em> 40 (3): 559–82. <a href="http://www.springerlink.com/?MUD=MP">http://www.springerlink.com/?MUD=MP</a>.
</div>
<div id="ref-zotero-1344" class="csl-entry" role="doc-biblioentry">
<span>“Welcome | <span>R</span> for <span>Data Science</span>.”</span> n.d. Accessed July 22, 2022. <a href="https://r4ds.had.co.nz/">https://r4ds.had.co.nz/</a>.
</div>
<div id="ref-R-tidyverse" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley. 2022. <em>Tidyverse: Easily Install and Load the Tidyverse</em>. <a href="https://CRAN.R-project.org/package=tidyverse">https://CRAN.R-project.org/package=tidyverse</a>.
</div>
<div id="ref-wickham2019" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019b. <span>“Welcome to the <span class="nocase">tidyverse</span>.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-tidyverse2019" class="csl-entry" role="doc-biblioentry">
———, et al. 2019a. <span>“Welcome to the <span class="nocase">tidyverse</span>.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-R-readxl" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, and Jennifer Bryan. 2022. <em>Readxl: Read Excel Files</em>. <a href="https://CRAN.R-project.org/package=readxl">https://CRAN.R-project.org/package=readxl</a>.
</div>
<div id="ref-xie2014" class="csl-entry" role="doc-biblioentry">
Xie, Yihui. 2014. <span>“Knitr: <span>A</span> Comprehensive Tool for Reproducible Research in <span>R</span>.”</span> In <em>Implementing Reproducible Computational Research</em>, edited by Victoria Stodden, Friedrich Leisch, and Roger D. Peng. <span>Chapman and Hall/CRC</span>. <a href="http://www.crcpress.com/product/isbn/9781466561595">http://www.crcpress.com/product/isbn/9781466561595</a>.
</div>
<div id="ref-xie2015" class="csl-entry" role="doc-biblioentry">
———. 2015. <em>Dynamic Documents with <span>R</span> and Knitr</em>. 2nd ed. <span>Boca Raton, Florida</span>: <span>Chapman and Hall/CRC</span>. <a href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</div>
<div id="ref-xie2022" class="csl-entry" role="doc-biblioentry">
———. 2022. <em>Knitr: <span>A</span> General-Purpose Package for Dynamic Report Generation in <span>R</span></em>. Manual. <a href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</div>
<div id="ref-xie2018" class="csl-entry" role="doc-biblioentry">
Xie, Yihui, J. J. Allaire, and Garrett Grolemund. 2018. <em>R Markdown: <span>The</span> Definitive Guide</em>. <span>Boca Raton, Florida</span>: <span>Chapman and Hall/CRC</span>. <a href="https://bookdown.org/yihui/rmarkdown">https://bookdown.org/yihui/rmarkdown</a>.
</div>
<div id="ref-xie2020" class="csl-entry" role="doc-biblioentry">
Xie, Yihui, Christophe Dervieux, and Emily Riederer. 2020. <em>R Markdown Cookbook</em>. <span>Boca Raton, Florida</span>: <span>Chapman and Hall/CRC</span>. <a href="https://bookdown.org/yihui/rmarkdown-cookbook">https://bookdown.org/yihui/rmarkdown-cookbook</a>.
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        function fireSlideChanged(previousSlide, currentSlide) {

          // dispatch for htmlwidgets
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for reveal
        if (window.Reveal) {
          window.Reveal.addEventListener("slidechanged", function(event) {
            fireSlideChanged(event.previousSlide, event.currentSlide);
          });
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        setTimeout(function() {
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const cites = ref.parentNode.getAttribute('data-cites').split(' ');
        tippyHover(ref, function() {
          var popup = window.document.createElement('div');
          cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    });
    </script>
    

</body></html>